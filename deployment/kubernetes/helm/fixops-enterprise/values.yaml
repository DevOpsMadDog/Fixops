# FixOps Enterprise Helm Chart - Production Values
# Gartner Magic Quadrant #1 Ready Configuration

global:
  imageRegistry: ""
  imagePullSecrets: []
  storageClass: ""

# FixOps API Server
api:
  replicaCount: 3
  image:
    repository: fixops/api
    tag: "enterprise-latest"
    pullPolicy: IfNotPresent
  service:
    type: LoadBalancer
    port: 80
    annotations:
      service.beta.kubernetes.io/aws-load-balancer-type: "nlb"
  resources:
    requests:
      cpu: "2"
      memory: "4Gi"
    limits:
      cpu: "4"
      memory: "8Gi"
  autoscaling:
    enabled: true
    minReplicas: 3
    maxReplicas: 20
    targetCPUUtilizationPercentage: 70
  podDisruptionBudget:
    minAvailable: 2

# FixOps Reachability Analyzer (Proprietary)
reachability:
  replicaCount: 5
  image:
    repository: fixops/reachability
    tag: "proprietary-latest"
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: "4"
      memory: "8Gi"
    limits:
      cpu: "8"
      memory: "16Gi"
  autoscaling:
    enabled: true
    minReplicas: 5
    maxReplicas: 50
    targetCPUUtilizationPercentage: 75
  jobQueue:
    workers: 10
    maxConcurrentJobs: 100

# FixOps Threat Intelligence Engine (Proprietary)
threatIntel:
  replicaCount: 2
  image:
    repository: fixops/threat-intel
    tag: "proprietary-latest"
    pullPolicy: IfNotPresent
  resources:
    requests:
      cpu: "1"
      memory: "2Gi"
    limits:
      cpu: "2"
      memory: "4Gi"
  feedRefreshInterval: "5m"

# PostgreSQL (Primary Database)
postgresql:
  enabled: true
  auth:
    postgresPassword: "CHANGE_ME"
    database: "fixops"
  primary:
    persistence:
      enabled: true
      size: "500Gi"
      storageClass: "gp3"
    resources:
      requests:
        cpu: "4"
        memory: "16Gi"
      limits:
        cpu: "8"
        memory: "32Gi"
  readReplicas:
    replicaCount: 2
    persistence:
      enabled: true
      size: "500Gi"

# Redis (Caching & Job Queue)
redis:
  enabled: true
  architecture: replication
  master:
    persistence:
      enabled: true
      size: "100Gi"
    resources:
      requests:
        cpu: "2"
        memory: "8Gi"
      limits:
        cpu: "4"
        memory: "16Gi"
  replica:
    replicaCount: 2
    persistence:
      enabled: true
      size: "100Gi"

# OpenTelemetry Collector
otel:
  enabled: true
  replicaCount: 2
  resources:
    requests:
      cpu: "500m"
      memory: "1Gi"
    limits:
      cpu: "1"
      memory: "2Gi"

# Multi-Tenancy
multiTenancy:
  enabled: true
  isolation: "namespace"  # namespace, network, database
  defaultTenant: "default"

# RBAC & SSO
rbac:
  enabled: true
  sso:
    enabled: true
    providers:
      - name: "saml"
        enabled: true
      - name: "oidc"
        enabled: true
      - name: "ldap"
        enabled: true

# Monitoring & Observability
monitoring:
  enabled: true
  prometheus:
    enabled: true
    retention: "30d"
  grafana:
    enabled: true
    dashboards:
      - "fixops-overview"
      - "fixops-performance"
      - "fixops-security"
  alerting:
    enabled: true
    rules:
      - name: "HighErrorRate"
        threshold: 5
      - name: "HighLatency"
        threshold: 200  # ms

# Security
security:
  podSecurityPolicy:
    enabled: true
  networkPolicy:
    enabled: true
  secretsManagement:
    provider: "vault"  # vault, aws-secrets-manager, azure-keyvault
  encryption:
    atRest: true
    inTransit: true
    tls:
      enabled: true
      certManager:
        enabled: true

# Backup & Disaster Recovery
backup:
  enabled: true
  schedule: "0 2 * * *"  # Daily at 2 AM
  retention: 30  # days
  provider: "s3"  # s3, gcs, azure-blob
  encryption: true

# Performance Tuning
performance:
  connectionPooling:
    enabled: true
    maxConnections: 100
  caching:
    enabled: true
    ttl: 3600  # seconds
  queryOptimization:
    enabled: true
    slowQueryThreshold: 1000  # ms

# High Availability
highAvailability:
  enabled: true
  zones: 3  # Multi-AZ deployment
  crossRegionReplication: false  # Enable for DR

# Resource Limits (Per Tenant)
resourceLimits:
  maxConcurrentAnalyses: 100
  maxRepositorySize: "10Gi"
  maxAnalysisDuration: "30m"
  rateLimit:
    requestsPerSecond: 100
    burstSize: 200

# Feature Flags
featureFlags:
  proprietaryAnalysis: true
  multiLLMConsensus: true
  zeroDayDetection: true
  automatedRemediation: true
  realTimeAnalysis: true
