# Example feature flags configuration for FixOps
# This file demonstrates how to configure feature flags in fixops.overlay.yml
#
# Add this section to your fixops.overlay.yml:
#
# feature_flags:
#   # Simple boolean flags
#   fixops.module.guardrails.enabled: true
#   
#   # Percentage-based rollouts (50% of tenants get the feature)
#   fixops.feature.llm.sentinel:
#     percentage: 50
#     value: true
#     hash_key: tenant_id
#   
#   # Multi-variant experiments (A/B/C testing)
#   fixops.model.risk.ab_test:
#     variants:
#       control: 50        # 50% get control (weighted_scoring_v1)
#       treatment: 30      # 30% get treatment (bn_lr_hybrid_v1)
#       variant_c: 20      # 20% get variant_c (bayesian_network_v1)
#     hash_key: tenant_id

feature_flags:
  # ===== P0: Critical Flags =====
  
  # Global kill switch (emergency stop)
  fixops.ops.kill_switch: false
  
  # Risk model flags
  fixops.model.risk.enabled: true
  fixops.model.risk.default: "bn_lr_hybrid_v1"
  fixops.model.risk.ab_test:
    variants:
      control: 70
      treatment: 30
    hash_key: tenant_id
  
  # LLM provider flags
  fixops.feature.llm.openai: true
  fixops.feature.llm.anthropic: true
  fixops.feature.llm.google: true
  fixops.feature.llm.sentinel: false  # Preview feature
  
  # External connector flags
  fixops.feature.connector.jira: true
  fixops.feature.connector.confluence: true
  fixops.feature.connector.slack: true
  
  # Circuit breakers
  fixops.ops.connector.circuit_breaker: true
  
  # ===== P1: High Priority Flags =====
  
  # Pipeline module flags
  fixops.module.guardrails.enabled: true
  fixops.module.compliance.enabled: true
  fixops.module.policy_automation.enabled: true
  fixops.module.evidence.enabled: true
  fixops.module.exploit_signals.enabled: true
  fixops.module.probabilistic.enabled: true
  fixops.module.enhanced_decision.enabled: true
  fixops.module.context_engine.enabled: true
  fixops.module.ssdlc.enabled: true
  fixops.module.iac_posture.enabled: true
  fixops.module.analytics.enabled: true
  
  # Telemetry flags
  fixops.ops.telemetry.enabled: true
  
  # Evidence features
  fixops.feature.evidence.encryption: false
  fixops.feature.evidence.retention_days: 90
  
  # Compliance framework selection
  fixops.feature.compliance.soc2: true
  fixops.feature.compliance.iso27001: true
  fixops.feature.compliance.pci_dss: false
  
  # ===== P2: Medium Priority Flags =====
  
  # CLI operation modes
  fixops.cli.offline_mode: false
  fixops.ops.dry_run: false
  
  # Rate limiting
  fixops.ops.rate_limit.enabled: true
  fixops.ops.rate_limit.requests_per_minute: 60
  
  # Entitlements (plan-based features)
  fixops.entitle.multi_llm_consensus: false
  fixops.entitle.advanced_analytics: false
  fixops.entitle.custom_policy_automation: false
  
  # ===== P3: Nice to Have Flags =====
  
  # Preview/experimental features
  fixops.preview.vector_store: false
  fixops.preview.ai_agents: false

# Example: Percentage-based rollout for a new feature
# Gradually roll out Sentinel LLM to 25% of tenants
# fixops.feature.llm.sentinel:
#   percentage: 25
#   value: true
#   hash_key: tenant_id

# Example: Multi-variant experiment for risk models
# Test three different models with different traffic splits
# fixops.model.risk.ab_test:
#   variants:
#     weighted_scoring_v1: 40
#     bayesian_network_v1: 30
#     bn_lr_hybrid_v1: 30
#   hash_key: cve_id

# Example: Per-tenant targeting (requires LaunchDarkly)
# In LaunchDarkly dashboard, create targeting rules like:
# - If tenant_id = "acme-corp", serve variant "treatment"
# - If plan = "enterprise", enable multi_llm_consensus
# - If region = "eu-west-1", enable specific compliance frameworks
