{
  "mode": "demo",
  "jira": {
    "url": "https://jira.example.com",
    "project_key": "FIX",
    "default_issue_type": "Task"
  },
  "confluence": {
    "base_url": "https://confluence.example.com",
    "space_key": "FIXOPS",
    "onboarding_page": "/display/FIXOPS/Demo+Runbook"
  },
  "git": {
    "provider": "github",
    "host": "https://github.com",
    "default_org": "fixops-demo"
  },
  "ci": {
    "provider": "github_actions",
    "pipeline_slug": "fixops/demo-pipeline"
  },
  "auth": {
    "strategy": "token",
    "token_env": "FIXOPS_API_TOKEN"
  },
  "data": {
    "design_context_dir": "design_context/demo",
    "evidence_dir": "evidence/demo",
    "feedback_dir": "feedback/demo"
  },
  "toggles": {
    "require_design_input": false,
    "auto_attach_overlay_metadata": true,
    "include_overlay_metadata_in_bundles": true,
    "enforce_ticket_sync": false,
    "capture_feedback": false
  },
  "modules": {
    "guardrails": {"enabled": true},
    "context_engine": {"enabled": true},
    "onboarding": {"enabled": true},
    "compliance": {"enabled": true},
    "policy_automation": {"enabled": true},
    "evidence": {"enabled": true},
    "ai_agents": {"enabled": true},
    "ssdlc": {"enabled": true},
    "exploit_signals": {"enabled": true},
    "probabilistic": {"enabled": true},
    "pricing": {"enabled": true},
    "iac_posture": {"enabled": true},
    "custom": []
  },
  "limits": {
    "max_upload_bytes": {
      "default": 3145728,
      "sarif": 6291456,
      "cve": 6291456
    }
  },
  "guardrails": {
    "maturity": "foundational",
    "profiles": {
      "foundational": {"fail_on": "critical", "warn_on": "high"},
      "scaling": {"fail_on": "high", "warn_on": "medium"},
      "advanced": {"fail_on": "medium", "warn_on": "medium"}
    }
  },
  "context_engine": {
    "fields": {
      "criticality": "customer_impact",
      "data": "data_classification",
      "exposure": "exposure"
    },
    "criticality_weights": {
      "mission_critical": 4,
      "external": 3,
      "internal": 1
    },
    "data_weights": {
      "pii": 4,
      "financial": 4,
      "health": 4,
      "internal": 2,
      "public": 1
    },
    "exposure_weights": {
      "internet": 3,
      "partner": 2,
      "internal": 1
    },
    "playbooks": [
      {"name": "Stabilise Customer Impact", "min_score": 9, "channel": "sre-pager"},
      {"name": "Sprint Triage", "min_score": 6, "channel": "appsec-kanban"},
      {"name": "Monitor", "min_score": 0, "channel": "platform-notifications"}
    ]
  },
  "evidence_hub": {
    "bundle_name": "fixops-run",
    "include_sections": [
      "design_summary",
      "sbom_summary",
      "sarif_summary",
      "cve_summary",
      "severity_overview",
      "context_summary",
      "guardrail_evaluation",
      "compliance_status",
      "probabilistic_forecast",
      "ai_agent_analysis",
      "ssdlc_assessment"
    ],
    "profiles": {
      "enterprise": {
        "bundle_name": "fixops-enterprise-run",
        "include_sections": [
          "design_summary",
          "sbom_summary",
          "sarif_summary",
          "cve_summary",
          "severity_overview",
          "context_summary",
          "guardrail_evaluation",
          "compliance_status",
          "policy_automation",
          "ai_agent_analysis",
          "ssdlc_assessment"
        ]
      }
    }
  },
  "onboarding": {
    "time_to_value_minutes": 30,
    "checklist": [
      {"step": "Upload design context CSV", "modes": ["demo", "enterprise"]},
      {"step": "Upload SBOM JSON", "modes": ["demo", "enterprise"]},
      {"step": "Upload SARIF scan", "modes": ["demo", "enterprise"]},
      {"step": "Upload CVE/KEV feed", "modes": ["demo", "enterprise"]},
      {"step": "Review context summary and guardrails", "modes": ["demo", "enterprise"]}
    ],
    "profiles": {
      "enterprise": {
        "time_to_value_minutes": 25,
        "checklist": [
          {"step": "Connect Jira project", "modes": ["enterprise"]},
          {"step": "Sync Confluence evidence space", "modes": ["enterprise"]},
          {"step": "Approve policy automation routes", "modes": ["enterprise"]}
        ]
      }
    }
  },
  "compliance": {
    "frameworks": [
      {
        "name": "SOC 2",
        "controls": [
          {"id": "CC8.1", "title": "Change Management Evidence", "requires": ["design", "guardrails", "evidence"]},
          {"id": "CC7.2", "title": "Continuous Vulnerability Management", "requires": ["sarif", "cve", "context"]}
        ]
      },
      {
        "name": "ISO 27001",
        "controls": [
          {"id": "A.12.6.1", "title": "Application vulnerability management", "requires": ["sbom", "cve"]}
        ]
      }
    ],
    "profiles": {
      "enterprise": {
        "frameworks": [
          {
            "name": "PCI DSS",
            "controls": [
              {"id": "6.3.3", "title": "Secure code reviews", "requires": ["sarif", "policy"]},
              {"id": "6.5", "title": "Vulnerability remediation", "requires": ["cve", "context", "guardrails"]}
            ]
          },
          {
            "name": "NIST 800-53",
            "controls": [
              {"id": "RA-5", "title": "Vulnerability scanning", "requires": ["sarif", "cve", "exploit"]},
              {"id": "CA-7", "title": "Continuous monitoring", "requires": ["context", "ssdlc", "iac_posture"]}
            ]
          }
        ]
      }
    }
  },
  "iac": {
    "targets": [
      {
        "id": "aws",
        "display_name": "AWS Cloud",
        "match": ["aws", "lambda", "s3"],
        "required_artifacts": ["policy_automation", "evidence_bundle"],
        "recommended_controls": ["iam-hardening", "network-segmentation"],
        "environments": ["prod", "production"]
      },
      {
        "id": "gcp",
        "display_name": "Google Cloud",
        "match": ["gcp", "gke", "cloud run"],
        "required_artifacts": ["context_summary", "compliance_status"],
        "recommended_controls": ["artifact-signing", "runtime-policy"],
        "environments": ["prod", "stage"]
      },
      {
        "id": "on_prem",
        "display_name": "On-Premises",
        "match": ["on-prem", "vmware", "bare metal"],
        "required_artifacts": ["context_summary"],
        "recommended_controls": ["patching-window", "backup-testing"],
        "environments": ["datacenter", "colo"]
      }
    ],
    "profiles": {
      "enterprise": {
        "targets": [
          {
            "id": "azure",
            "display_name": "Azure Cloud",
            "match": ["azure", "aks", "app service"],
            "required_artifacts": ["policy_automation", "compliance_status", "evidence_bundle"],
            "recommended_controls": ["defender-integration", "policy-enforcement"],
            "environments": ["prod", "dr"]
          }
        ]
      }
    }
  },
  "policy_automation": {
    "actions": [
      {
        "trigger": "guardrail:fail",
        "type": "jira_issue",
        "summary": "Escalate failing guardrail",
        "priority": "Highest"
      },
      {
        "trigger": "context:high",
        "type": "slack",
        "channel": "#fixops-critical"
      }
    ],
    "profiles": {
      "enterprise": {
        "actions": [
          {
            "trigger": "guardrail:fail",
            "type": "jira_issue",
            "summary": "Enterprise risk exception required",
            "priority": "Blocker"
          },
          {
            "trigger": "compliance:gap",
            "type": "confluence_page",
            "space": "FIXOPS-ENT"
          }
        ]
      }
    }
  },
  "ssdlc": {
    "stages": [
      {
        "id": "plan",
        "name": "Plan & Threat Modelling",
        "description": "Design artefacts, agent inventory, and threat modelling captured during planning.",
        "requirements": [
          {"key": "design", "title": "Design artefact uploaded"},
          {"key": "threat_model", "title": "Threat modelling documented"},
          {"key": "ai_register", "title": "Agent frameworks registered"}
        ]
      },
      {
        "id": "code",
        "name": "Code & Dependency Hygiene",
        "description": "Source composition analysed with pinned dependencies for agent services.",
        "requirements": [
          {"key": "sbom", "title": "SBOM provided"},
          {"key": "dependency_pinning", "title": "Dependencies pinned"}
        ]
      },
      {
        "id": "build",
        "name": "Build & Static Testing",
        "description": "Static analysis and guardrails executed in CI pipelines.",
        "requirements": [
          {"key": "sarif", "title": "Static scan ingested"},
          {"key": "guardrails", "title": "Guardrail evaluation completed"}
        ]
      },
      {
        "id": "test",
        "name": "Threat Testing & CTEM",
        "description": "Threat intelligence and contextual rescoring drive automation outcomes.",
        "requirements": [
          {"key": "cve", "title": "CVE or KEV feed analysed"},
          {"key": "policy_automation", "title": "Policy automation triggered"}
        ]
      },
      {
        "id": "deploy",
        "name": "Deploy Approvals",
        "description": "Change management approvals aligned to contextual risk.",
        "requirements": [
          {"key": "compliance", "title": "Compliance pack coverage"},
          {"key": "deploy_approvals", "title": "Approval hooks configured"}
        ]
      },
      {
        "id": "run",
        "name": "Run & Observability",
        "description": "Runtime artefacts captured for operational observability.",
        "requirements": [
          {"key": "evidence", "title": "Evidence bundle persisted"},
          {"key": "observability", "title": "Context and guardrail telemetry"}
        ]
      },
      {
        "id": "audit",
        "name": "Audit & Feedback",
        "description": "Audit-ready packaging and structured waiver capture.",
        "requirements": [
          {"key": "evidence", "title": "Evidence bundle available"},
          {"key": "feedback_loop", "title": "Feedback capture enabled"}
        ]
      }
    ],
    "profiles": {
      "enterprise": {
        "stages": [
          {
            "id": "deploy",
            "description": "Enterprise deployments require ticketing and documentation hand-offs.",
            "requirements": [
              {"key": "compliance", "title": "Enterprise compliance packs satisfied"},
              {"key": "deploy_approvals", "title": "Enterprise approval hooks configured"}
            ]
          },
          {
            "id": "audit",
            "requirements": [
              {"key": "evidence", "title": "Enterprise evidence bundle"},
              {"key": "feedback_loop", "title": "Feedback capture enabled"}
            ]
          }
        ]
      }
    }
  },
  "ai_agents": {
    "watchlist_version": "2024-07",
    "framework_signatures": [
      {"name": "LangChain", "keywords": ["langchain", "llmchain"], "threat_profile": "supply_chain"},
      {"name": "AutoGPT", "keywords": ["autogpt", "auto-gpt"], "threat_profile": "self_modifying"},
      {"name": "CrewAI", "keywords": ["crewai"], "threat_profile": "multi_agent_coordination"},
      {"name": "HuggingFace Agents", "keywords": ["huggingface agent", "transformers agent"], "threat_profile": "remote_tool_execution"},
      {"name": "LlamaIndex", "keywords": ["llamaindex", "gpt index"], "threat_profile": "data_leakage"}
    ],
    "controls": {
      "default": {
        "recommended_controls": [
          "Document tool/API access scopes",
          "Require prompt/response audit logging",
          "Validate model inputs for sensitive data"
        ],
        "residual_risks": [
          "Prompt injection against tool-calling agents",
          "Unbounded data exfiltration via third-party APIs"
        ]
      },
      "autogpt": {
        "recommended_controls": [
          "Disable autonomous resource creation in production",
          "Enforce manual approval on destructive actions"
        ]
      }
    },
    "playbooks": [
      {
        "name": "AI Agent Hardening",
        "channel": "appsec-ai",
        "triggers": ["agent"],
        "frameworks": ["LangChain", "AutoGPT", "CrewAI"]
      },
      {
        "name": "Model Supply Chain Review",
        "channel": "sre-risk",
        "triggers": ["agent"],
        "frameworks": ["HuggingFace Agents", "LlamaIndex"]
      }
    ]
  },
  "exploit_signals": {
    "signals": {
      "kev": {
        "label": "CISA Known Exploited Vulnerability",
        "mode": "boolean",
        "fields": ["knownExploited", "kev", "knownRansomwareCampaignUse"],
        "truthy": [true, "true", "yes", 1],
        "escalate_to": "critical",
        "rationale": "CISA KEV catalogue mandates expedited remediation for actively exploited vulnerabilities."
      },
      "epss": {
        "label": "Exploit Prediction Scoring System",
        "mode": "probability",
        "fields": ["epss", "epssScore", "exploitability.epss"],
        "threshold": 0.5,
        "severity_floor": "high",
        "rationale": "FIRST EPSS research indicates probabilities above 0.5 correlate with imminent exploitation risk."
      }
    },
    "references": [
      "https://www.cisa.gov/known-exploited-vulnerabilities-catalog",
      "https://www.first.org/epss"
    ],
    "profiles": {
      "enterprise": {
        "signals": {
          "epss": {"threshold": 0.3},
          "kev": {"escalate_to": "critical"}
        }
      }
    }
  },
  "probabilistic": {
    "bayesian_prior": {
      "low": 0.4,
      "medium": 0.9,
      "high": 1.2,
      "critical": 1.4
    },
    "markov_transitions": {
      "low": {"low": 0.82, "medium": 0.15, "high": 0.03},
      "medium": {"medium": 0.62, "high": 0.28, "critical": 0.1},
      "high": {"high": 0.55, "critical": 0.3, "medium": 0.15},
      "critical": {"critical": 0.72, "high": 0.28}
    },
    "component_limit": 5,
    "escalate_from": "medium",
    "profiles": {
      "enterprise": {
        "component_limit": 8,
        "bayesian_prior": {
          "medium": 1.1,
          "high": 1.5,
          "critical": 1.8
        },
        "markov_transitions": {
          "medium": {"medium": 0.55, "high": 0.32, "critical": 0.13},
          "high": {"high": 0.5, "critical": 0.35, "medium": 0.15}
        }
      }
    }
  },
  "pricing": {
    "plans": [
      {
        "name": "Launch",
        "mode": "demo",
        "included_scans": 50,
        "evidence_storage_gb": 5,
        "price_per_month_usd": 499
      },
      {
        "name": "Scale",
        "mode": "enterprise",
        "included_scans": 500,
        "evidence_storage_gb": 100,
        "price_per_month_usd": 3999
      }
    ]
  },
  "profiles": {
    "enterprise": {
      "mode": "enterprise",
      "jira": {
        "project_key": "FIXOPS",
        "default_issue_type": "Security Review",
        "workflow_scheme": "Enterprise Risk"
      },
      "confluence": {
        "space_key": "FIXOPS-ENT",
        "onboarding_page": "/display/FIXOPS-ENT/Control+Runbook"
      },
      "git": {
        "provider": "gitlab",
        "host": "https://gitlab.example.com",
        "default_group": "fixops"
      },
      "ci": {
        "provider": "gitlab_ci",
        "pipeline_slug": "fixops/enterprise/security"
      },
      "auth": {
        "strategy": "oidc",
        "client_id": "fixops-enterprise"
      },
      "data": {
        "design_context_dir": "design_context/enterprise",
        "evidence_dir": "evidence/enterprise",
        "audit_export_dir": "audit",
        "feedback_dir": "feedback/enterprise"
      },
      "toggles": {
        "require_design_input": true,
        "enforce_ticket_sync": true,
        "capture_feedback": true,
        "include_overlay_metadata_in_bundles": false
      },
      "limits": {
        "max_upload_bytes": {
          "default": 7340032,
          "sarif": 10485760,
          "cve": 10485760
        }
      },
      "guardrails": {
        "maturity": "advanced"
      }
    }
  }
}
