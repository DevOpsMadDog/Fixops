{
  "scan_id": "sonar-pay-2025-001",
  "tool": "sonarqube",
  "tool_version": "10.3",
  "scan_type": "sast",
  "timestamp": "2025-01-15T08:00:00Z",
  "application": "payment-gateway",
  "branch": "main",
  "commit": "abc123def456",
  "quality_gate": "failed",
  "metrics": {
    "lines_of_code": 45000,
    "coverage": 78.5,
    "duplications": 3.2,
    "technical_debt_days": 12
  },
  "findings": [
    {
      "id": "SONAR-PAY-001",
      "rule_id": "java:S3649",
      "title": "SQL Injection vulnerability",
      "severity": "critical",
      "type": "vulnerability",
      "cwe": "CWE-89",
      "owasp": "A03:2021",
      "file": "src/main/java/com/payment/dao/TransactionDAO.java",
      "line": 145,
      "code_snippet": "String query = \"SELECT * FROM transactions WHERE id = '\" + transactionId + \"'\";",
      "message": "Use parameterized queries instead of string concatenation",
      "effort_minutes": 30,
      "tags": ["sql-injection", "security", "pci-dss"],
      "correlation_id": "CORR-SQL-001"
    },
    {
      "id": "SONAR-PAY-002",
      "rule_id": "java:S5131",
      "title": "Cross-Site Scripting (XSS)",
      "severity": "high",
      "type": "vulnerability",
      "cwe": "CWE-79",
      "owasp": "A03:2021",
      "file": "src/main/java/com/payment/controller/PaymentController.java",
      "line": 89,
      "code_snippet": "response.getWriter().write(userInput);",
      "message": "Sanitize user input before rendering in response",
      "effort_minutes": 45,
      "tags": ["xss", "security"],
      "correlation_id": "CORR-XSS-001"
    },
    {
      "id": "SONAR-PAY-003",
      "rule_id": "java:S2068",
      "title": "Hardcoded credentials",
      "severity": "critical",
      "type": "vulnerability",
      "cwe": "CWE-798",
      "owasp": "A07:2021",
      "file": "src/main/java/com/payment/config/DatabaseConfig.java",
      "line": 23,
      "code_snippet": "private static final String DB_PASSWORD = \"prod_secret_123\";",
      "message": "Remove hardcoded credentials and use environment variables",
      "effort_minutes": 15,
      "tags": ["credentials", "security", "pci-dss"],
      "correlation_id": "CORR-CRED-001"
    },
    {
      "id": "SONAR-PAY-004",
      "rule_id": "java:S4790",
      "title": "Weak cryptographic hash",
      "severity": "high",
      "type": "vulnerability",
      "cwe": "CWE-328",
      "owasp": "A02:2021",
      "file": "src/main/java/com/payment/security/HashUtil.java",
      "line": 34,
      "code_snippet": "MessageDigest md = MessageDigest.getInstance(\"MD5\");",
      "message": "Use SHA-256 or stronger hash algorithm",
      "effort_minutes": 20,
      "tags": ["crypto", "security", "pci-dss"],
      "correlation_id": "CORR-CRYPTO-001"
    },
    {
      "id": "SONAR-PAY-005",
      "rule_id": "java:S5344",
      "title": "Insecure random number generator",
      "severity": "medium",
      "type": "vulnerability",
      "cwe": "CWE-330",
      "owasp": "A02:2021",
      "file": "src/main/java/com/payment/util/TokenGenerator.java",
      "line": 56,
      "code_snippet": "Random random = new Random();",
      "message": "Use SecureRandom for security-sensitive operations",
      "effort_minutes": 10,
      "tags": ["random", "security"],
      "correlation_id": "CORR-RANDOM-001"
    }
  ],
  "summary": {
    "total": 5,
    "critical": 2,
    "high": 2,
    "medium": 1,
    "low": 0
  }
}
