{
  "scan_time": "2024-10-28T14:15:00Z",
  "scanner": "Wiz Cloud Security Platform",
  "scanner_version": "2024.10.1",
  "cloud_provider": "AWS",
  "account_id": "345678901234",
  "region": "us-east-1",
  "findings": [
    {"id": "WIZ-S-001", "type": "k8s:tenant_isolation", "severity": "critical", "resource": "namespace/tenant-a/pod/analytics-service", "resource_type": "kubernetes_pod", "title": "Tenant isolation breach - pod can access other tenants' namespaces", "description": "Analytics service pod in tenant-a namespace has cluster-wide permissions allowing access to resources in other tenant namespaces. Critical multi-tenant isolation failure.", "remediation": "Implement namespace-scoped RBAC. Remove cluster-wide permissions. Enable Pod Security Standards.", "compliance_frameworks": ["SOC2", "ISO27001", "GDPR"], "control_ids": ["CC6.1", "A.9.4.1", "Art-32"], "cwe": ["CWE-284"], "cvss": 9.1, "first_detected": "2024-10-25T10:00:00Z", "status": "open", "tags": ["multi-tenant", "isolation", "critical", "kubernetes"]},
    {"id": "WIZ-S-002", "type": "db:row_level_security", "severity": "critical", "resource": "aws/rds/instance/timescaledb-prod", "resource_type": "rds_instance", "title": "TimescaleDB lacks row-level security for tenant isolation", "description": "TimescaleDB instance stores multi-tenant metrics data but does not have row-level security (RLS) policies configured. SQL queries could access other tenants' data.", "remediation": "Enable PostgreSQL row-level security. Create RLS policies for tenant_id column. Test tenant isolation.", "compliance_frameworks": ["SOC2", "ISO27001", "GDPR"], "control_ids": ["CC6.1", "A.9.4.1", "Art-32"], "cwe": ["CWE-284"], "cvss": 9.3, "first_detected": "2024-10-20T14:00:00Z", "status": "open", "tags": ["database", "tenant-isolation", "rls", "critical"]},
    {"id": "WIZ-S-003", "type": "storage:tenant_isolation", "severity": "high", "resource": "minio/bucket/exports", "resource_type": "object_storage", "title": "MinIO bucket policy allows cross-tenant file access", "description": "MinIO bucket 'exports' has overly permissive policy allowing users to list and download files from other tenants' directories.", "remediation": "Implement bucket policies with tenant_id prefix restrictions. Enable audit logging.", "compliance_frameworks": ["SOC2", "GDPR"], "control_ids": ["CC6.1", "Art-32"], "cwe": ["CWE-284"], "cvss": 7.5, "first_detected": "2024-10-22T11:00:00Z", "status": "open", "tags": ["storage", "tenant-isolation", "minio"]},
    {"id": "WIZ-S-004", "type": "api:rate_limiting", "severity": "medium", "resource": "api/export-service", "resource_type": "api_endpoint", "title": "Export API lacks rate limiting - data exfiltration risk", "description": "Export service API endpoints do not have rate limiting configured. Attackers could rapidly export large volumes of data.", "remediation": "Implement rate limiting (100 requests/hour per tenant). Add export size limits. Enable audit logging.", "compliance_frameworks": ["SOC2", "GDPR"], "control_ids": ["CC6.1", "Art-32"], "cwe": ["CWE-770"], "cvss": 6.5, "first_detected": "2024-10-15T09:00:00Z", "status": "open", "tags": ["api", "rate-limiting", "data-exfiltration"]},
    {"id": "WIZ-S-005", "type": "credentials:exposed", "severity": "critical", "resource": "k8s/sensitive_value/jwt-sensitive_value", "resource_type": "kubernetes_secret", "title": "JWT sensitive_value key stored in plain text Kubernetes sensitive_value", "description": "JWT sensitive_value key stored in Kubernetes sensitive_value without encryption at rest. Cluster compromise would expose all tenant authentication.", "remediation": "Enable Kubernetes sensitive_values encryption at rest. Rotate JWT sensitive_value. Consider external sensitive_value management (AWS sensitive_values Manager).", "compliance_frameworks": ["SOC2", "ISO27001"], "control_ids": ["CC6.1", "A.10.1.1"], "cwe": ["CWE-311"], "cvss": 8.8, "first_detected": "2024-10-18T13:00:00Z", "status": "open", "tags": ["sensitive_values", "kubernetes", "jwt", "encryption"]},
    {"id": "WIZ-S-006", "type": "network:websocket", "severity": "medium", "resource": "service/websocket-server", "resource_type": "service", "title": "WebSocket server lacks authentication auth_value validation", "description": "WebSocket server accepts connections without validating JWT auth_values. Could allow unauthorized real-time data access.", "remediation": "Implement JWT validation in WebSocket handshake. Add connection rate limiting.", "compliance_frameworks": ["SOC2"], "control_ids": ["CC6.1"], "cwe": ["CWE-306"], "cvss": 6.5, "first_detected": "2024-10-10T10:00:00Z", "status": "open", "tags": ["websocket", "authentication", "real-time"]},
    {"id": "WIZ-S-007", "type": "compliance:gdpr", "severity": "high", "resource": "service/analytics-service", "resource_type": "service", "title": "Analytics service lacks data retention policy enforcement", "description": "Analytics service stores user behavior data indefinitely without retention policy. GDPR Article 5 requires data minimization and retention limits.", "remediation": "Implement automated data retention policy (90 days for analytics). Add data deletion workflows.", "compliance_frameworks": ["GDPR", "SOC2"], "control_ids": ["Art-5", "CC6.1"], "cwe": ["CWE-359"], "cvss": 7.1, "first_detected": "2024-10-05T14:00:00Z", "status": "open", "tags": ["gdpr", "retention", "privacy"]},
    {"id": "WIZ-S-008", "type": "container:vulnerability", "severity": "high", "resource": "container/query-service:v4.8.2", "resource_type": "container_image", "title": "Query service container contains 2 KEV-listed CVEs", "description": "Container image contains CVE-2024-7348 (psycopg2 SQL injection) and CVE-2024-5432 (MinIO auth bypass). Both are KEV-listed with active exploitation.", "remediation": "Rebuild container with psycopg2-binary@2.9.10 and minio@2024.01.15. Deploy emergency patch.", "compliance_frameworks": ["SOC2"], "control_ids": ["CC6.1"], "cwe": ["CWE-1035"], "cvss": 8.8, "first_detected": "2024-10-26T09:00:00Z", "status": "open", "tags": ["container", "kev", "vulnerability"]}
  ],
  "summary": {"total_findings": 8, "critical": 3, "high": 3, "medium": 2, "by_type": {"k8s:tenant_isolation": 1, "db:row_level_security": 1, "storage:tenant_isolation": 1, "api:rate_limiting": 1, "sensitive_values:exposed": 1, "network:websocket": 1, "compliance:gdpr": 1, "container:vulnerability": 1}, "compliance_gaps": {"SOC2": 7, "ISO27001": 3, "GDPR": 4}}
}
