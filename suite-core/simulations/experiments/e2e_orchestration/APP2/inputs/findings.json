{
  "scan_time": "2024-10-28T13:15:00Z",
  "scanner": "Wiz Cloud Security Platform",
  "scanner_version": "2024.10.1",
  "cloud_provider": "AWS",
  "account_id": "234567890123",
  "region": "us-east-1",
  "findings": [
    {
      "id": "WIZ-E-001",
      "type": "k8s:misconfig",
      "severity": "critical",
      "resource": "namespace/prod/deployment/payment-service",
      "resource_type": "kubernetes_deployment",
      "title": "Payment service running as root with privileged container",
      "description": "The payment-service deployment runs containers as root (UID 0) with privileged mode enabled. This violates PCI-DSS requirements and creates significant security risk for payment processing workloads.",
      "remediation": "Set securityContext.runAsNonRoot: true and remove privileged: true. Create dedicated service account with minimal permissions.",
      "compliance_frameworks": ["PCI-DSS", "SOC2", "GDPR"],
      "control_ids": ["Req-2.2.4", "CC6.1", "Art-32"],
      "cwe": ["CWE-250"],
      "cvss": 9.3,
      "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H",
      "first_detected": "2024-10-20T09:00:00Z",
      "last_seen": "2024-10-28T13:15:00Z",
      "status": "open",
      "tags": ["kubernetes", "container", "pci", "privileged", "critical"]
    },
    {
      "id": "WIZ-E-002",
      "type": "network:security_group",
      "severity": "critical",
      "resource": "aws/ec2/security-group/sg-kafka-prod",
      "resource_type": "security_group",
      "title": "Kafka broker security group allows unrestricted access from 0.0.0.0/0",
      "description": "Security group for MSK Kafka cluster allows inbound traffic on ports 9092, 9094, and 9096 from any IP address (0.0.0.0/0). This exposes sensitive order and user event streams to the internet.",
      "remediation": "Restrict inbound access to VPC CIDR blocks only. Remove 0.0.0.0/0 rules immediately. Enable VPC peering for cross-VPC access.",
      "compliance_frameworks": ["SOC2", "GDPR", "PCI-DSS"],
      "control_ids": ["CC6.1", "Art-32", "Req-1.3"],
      "cwe": ["CWE-284"],
      "cvss": 9.8,
      "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
      "first_detected": "2024-10-22T11:30:00Z",
      "last_seen": "2024-10-28T13:15:00Z",
      "status": "open",
      "tags": ["network", "kafka", "exposure", "critical", "pii"]
    },
    {
      "id": "WIZ-E-003",
      "type": "storage:encryption",
      "severity": "high",
      "resource": "aws/rds/cluster/orders-db-prod",
      "resource_type": "rds_cluster",
      "title": "RDS cluster storing PII/PCI data lacks encryption at rest",
      "description": "PostgreSQL RDS cluster 'orders-db-prod' stores order history and payment records but does not have encryption at rest enabled. This violates PCI-DSS Requirement 3.4 and GDPR Article 32.",
      "remediation": "Enable encryption at rest for RDS cluster. Note: Requires creating new encrypted cluster and migrating data. Schedule maintenance window.",
      "compliance_frameworks": ["PCI-DSS", "GDPR", "SOC2"],
      "control_ids": ["Req-3.4", "Art-32", "CC6.1"],
      "cwe": ["CWE-311"],
      "cvss": 7.5,
      "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
      "first_detected": "2024-09-15T14:00:00Z",
      "last_seen": "2024-10-28T13:15:00Z",
      "status": "open",
      "tags": ["encryption", "database", "pii", "pci", "compliance"]
    },
    {
      "id": "WIZ-E-004",
      "type": "credentials:exposed",
      "severity": "critical",
      "resource": "aws/valuestore/sensitive_value/stripe-live-key",
      "resource_type": "secrets_manager",
      "title": "Stripe production API config found in application logs and environment variables",
      "description": "Production Stripe sensitive_value key (STRIPE_KEY_PLACEHOLDER...) detected in CloudWatch Logs and exposed in Kubernetes ConfigMap. This creates immediate risk of payment fraud and PCI-DSS violation.",
      "remediation": "Rotate Stripe API reference immediately. Move to AWS sensitive_values Manager with IAM-based access. Remove from ConfigMaps and environment variables. Implement sensitive_value scanning in CI/CD.",
      "compliance_frameworks": ["PCI-DSS", "SOC2"],
      "control_ids": ["Req-3.4", "CC6.1"],
      "cwe": ["CWE-798", "CWE-532"],
      "cvss": 9.8,
      "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
      "first_detected": "2024-10-27T18:20:00Z",
      "last_seen": "2024-10-28T13:15:00Z",
      "status": "open",
      "tags": ["sensitive_values", "credentials", "pci", "critical", "stripe"]
    },
    {
      "id": "WIZ-E-005",
      "type": "iam:overprivileged",
      "severity": "high",
      "resource": "aws/iam/role/eks-node-role-prod",
      "resource_type": "iam_role",
      "title": "EKS node role has AdministratorAccess policy attached",
      "description": "IAM role 'eks-node-role-prod' used by all EKS worker nodes has AdministratorAccess policy, granting full AWS account access to all pods. This violates least-privilege principle.",
      "remediation": "Remove AdministratorAccess policy. Create granular policies for specific service needs. Implement IRSA (IAM Roles for Service Accounts) for pod-level permissions.",
      "compliance_frameworks": ["SOC2", "PCI-DSS"],
      "control_ids": ["CC6.1", "Req-7.1"],
      "cwe": ["CWE-269"],
      "cvss": 8.8,
      "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
      "first_detected": "2024-10-10T10:00:00Z",
      "last_seen": "2024-10-28T13:15:00Z",
      "status": "open",
      "tags": ["iam", "permissions", "least-privilege", "kubernetes"]
    },
    {
      "id": "WIZ-E-006",
      "type": "container:vulnerability",
      "severity": "critical",
      "resource": "container/order-service:v3.12.5",
      "resource_type": "container_image",
      "title": "Order service container contains Log4Shell and 8 other critical CVEs",
      "description": "Container image contains CVE-2021-44228 (Log4Shell), CVE-2024-5629 (MongoDB injection), CVE-2024-7890 (PostgreSQL injection), and 6 additional critical vulnerabilities. KEV-listed vulnerabilities with active exploitation.",
      "remediation": "Rebuild container with updated dependencies: log4j-core@2.17.1, mongodb-driver-sync@4.11.2, postgresql@42.6.1. Deploy emergency patch.",
      "compliance_frameworks": ["SOC2", "PCI-DSS"],
      "control_ids": ["CC6.1", "Req-6.2"],
      "cwe": ["CWE-1035"],
      "cvss": 10.0,
      "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H",
      "first_detected": "2024-10-25T08:00:00Z",
      "last_seen": "2024-10-28T13:15:00Z",
      "status": "open",
      "tags": ["container", "vulnerability", "log4shell", "kev", "critical"]
    },
    {
      "id": "WIZ-E-007",
      "type": "k8s:rbac",
      "severity": "high",
      "resource": "namespace/prod/serviceaccount/default",
      "resource_type": "kubernetes_serviceaccount",
      "title": "Default service account has cluster-admin privileges across all namespaces",
      "description": "The default service account in prod namespace has cluster-admin role binding, granting unrestricted access to all Kubernetes resources. All pods using default SA inherit these permissions.",
      "remediation": "Remove cluster-admin binding from default service account. Create dedicated service accounts with namespace-scoped roles for each application.",
      "compliance_frameworks": ["SOC2"],
      "control_ids": ["CC6.1"],
      "cwe": ["CWE-269"],
      "cvss": 8.1,
      "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:N",
      "first_detected": "2024-10-12T12:00:00Z",
      "last_seen": "2024-10-28T13:15:00Z",
      "status": "open",
      "tags": ["kubernetes", "rbac", "permissions", "least-privilege"]
    },
    {
      "id": "WIZ-E-008",
      "type": "compliance:pci",
      "severity": "high",
      "resource": "aws/s3/bucket/order-documents-prod",
      "resource_type": "s3_bucket",
      "title": "S3 bucket with payment records lacks access logging and versioning",
      "description": "S3 bucket 'order-documents-prod' stores invoices and payment receipts but lacks access logging and versioning. PCI-DSS requires audit trails and data retention controls.",
      "remediation": "Enable S3 access logging with 7-year retention. Enable versioning with lifecycle policies. Configure MFA delete protection.",
      "compliance_frameworks": ["PCI-DSS", "SOC2"],
      "control_ids": ["Req-10.2", "CC7.2"],
      "cwe": ["CWE-778"],
      "cvss": 6.5,
      "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L",
      "first_detected": "2024-10-05T15:00:00Z",
      "last_seen": "2024-10-28T13:15:00Z",
      "status": "open",
      "tags": ["compliance", "pci", "audit", "logging", "s3"]
    },
    {
      "id": "WIZ-E-009",
      "type": "network:tls",
      "severity": "medium",
      "resource": "aws/alb/marketplace-alb-prod",
      "resource_type": "load_balancer",
      "title": "ALB supports deprecated TLS 1.0 and 1.1 protocols",
      "description": "Application Load Balancer supports TLS 1.0 and 1.1 which are deprecated and vulnerable. PCI-DSS 4.0 requires TLS 1.2 minimum.",
      "remediation": "Update ALB security policy to ELBSecurityPolicy-TLS13-1-2-2021-06. Test client compatibility before deployment.",
      "compliance_frameworks": ["PCI-DSS", "SOC2"],
      "control_ids": ["Req-4.1", "CC6.1"],
      "cwe": ["CWE-327"],
      "cvss": 5.9,
      "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
      "first_detected": "2024-09-20T11:00:00Z",
      "last_seen": "2024-10-28T13:15:00Z",
      "status": "open",
      "tags": ["tls", "encryption", "pci", "compliance"]
    },
    {
      "id": "WIZ-E-010",
      "type": "data:exposure",
      "severity": "high",
      "resource": "aws/documentdb/cluster/product-catalog-prod",
      "resource_type": "documentdb_cluster",
      "title": "DocumentDB cluster publicly accessible with weak authentication",
      "description": "DocumentDB cluster 'product-catalog-prod' is configured as publicly accessible with only auth_string authentication (no TLS client certificates). Exposed to internet on port 27017.",
      "remediation": "Disable public accessibility. Move to private subnets with VPC endpoints. Enable TLS with client certificate authentication.",
      "compliance_frameworks": ["SOC2", "GDPR"],
      "control_ids": ["CC6.1", "Art-32"],
      "cwe": ["CWE-284"],
      "cvss": 7.5,
      "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
      "first_detected": "2024-10-18T13:30:00Z",
      "last_seen": "2024-10-28T13:15:00Z",
      "status": "open",
      "tags": ["database", "exposure", "mongodb", "public"]
    },
    {
      "id": "WIZ-E-011",
      "type": "k8s:network_policy",
      "severity": "medium",
      "resource": "namespace/prod",
      "resource_type": "kubernetes_namespace",
      "title": "Production namespace lacks network policies for pod-to-pod communication",
      "description": "No network policies defined in prod namespace. All pods can communicate with each other without restrictions, violating network segmentation requirements.",
      "remediation": "Implement Kubernetes NetworkPolicies to restrict pod-to-pod communication. Allow only necessary service-to-service traffic.",
      "compliance_frameworks": ["SOC2", "PCI-DSS"],
      "control_ids": ["CC6.1", "Req-1.3"],
      "cwe": ["CWE-284"],
      "cvss": 5.3,
      "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N",
      "first_detected": "2024-10-08T09:00:00Z",
      "last_seen": "2024-10-28T13:15:00Z",
      "status": "open",
      "tags": ["kubernetes", "network-policy", "segmentation"]
    },
    {
      "id": "WIZ-E-012",
      "type": "compliance:gdpr",
      "severity": "high",
      "resource": "aws/elasticache/cluster/session-cache-prod",
      "resource_type": "elasticache_cluster",
      "title": "ElastiCache cluster storing user sessions lacks encryption in transit",
      "description": "Redis ElastiCache cluster stores user session data including PII but does not have encryption in transit enabled. GDPR Article 32 requires encryption of personal data.",
      "remediation": "Enable encryption in transit for ElastiCache cluster. Update application to use TLS connections. Requires cluster recreation.",
      "compliance_frameworks": ["GDPR", "SOC2"],
      "control_ids": ["Art-32", "CC6.1"],
      "cwe": ["CWE-319"],
      "cvss": 7.4,
      "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:N",
      "first_detected": "2024-10-01T10:00:00Z",
      "last_seen": "2024-10-28T13:15:00Z",
      "status": "open",
      "tags": ["encryption", "redis", "gdpr", "pii", "transit"]
    }
  ],
  "summary": {
    "total_findings": 12,
    "critical": 4,
    "high": 6,
    "medium": 2,
    "low": 0,
    "by_type": {
      "k8s:misconfig": 1,
      "network:security_group": 1,
      "storage:encryption": 1,
      "sensitive_values:exposed": 1,
      "iam:overprivileged": 1,
      "container:vulnerability": 1,
      "k8s:rbac": 1,
      "compliance:pci": 1,
      "network:tls": 1,
      "data:exposure": 1,
      "k8s:network_policy": 1,
      "compliance:gdpr": 1
    },
    "compliance_gaps": {
      "PCI-DSS": 8,
      "SOC2": 10,
      "GDPR": 5,
      "CCPA": 1
    }
  }
}
