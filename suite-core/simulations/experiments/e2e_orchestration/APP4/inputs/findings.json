{
  "scan_time": "2024-10-28T15:15:00Z",
  "scanner": "Wiz Cloud Security Platform + ICS-CERT Scanner",
  "scanner_version": "2024.10.1",
  "cloud_provider": "AWS + On-Premises",
  "account_id": "456789012345",
  "region": "us-east-1 + edge-locations",
  "findings": [
    {"id": "WIZ-I-001", "type": "iot:device_hijacking", "severity": "critical", "resource": "mqtt/broker/prod", "resource_type": "mqtt_broker", "title": "MQTT broker vulnerable to device hijacking via authentication bypass (CVE-2023-0809)", "description": "Eclipse Mosquitto 2.0.18 contains KEV-listed authentication bypass vulnerability. 500K+ connected devices at risk of hijacking. Could enable botnet recruitment or malicious device commands.", "remediation": "EMERGENCY: Upgrade to Mosquitto 2.0.19. Implement certificate-based authentication. Deploy within 4 hours.", "compliance_frameworks": ["IEC62443", "NERC-CIP", "SOC2"], "control_ids": ["SR-1.1", "CIP-005-6", "CC6.1"], "cwe": ["CWE-287"], "cvss": 9.8, "first_detected": "2024-10-27T20:00:00Z", "status": "open", "tags": ["iot", "mqtt", "kev", "critical", "device-hijacking"]},
    {"id": "WIZ-I-002", "type": "iot:firmware_tampering", "severity": "critical", "resource": "service/firmware-service", "resource_type": "service", "title": "Firmware update service lacks code signing verification", "description": "Firmware service does not verify code signatures before deploying updates to devices. Attackers could deploy malicious firmware to 500K+ devices.", "remediation": "Implement code signing with HSM-backed keys. Add signature verification to firmware deployment pipeline. Enable rollback capability.", "compliance_frameworks": ["IEC62443", "SOC2", "ISO27001"], "control_ids": ["SR-3.1", "CC6.1", "A.14.2.9"], "cwe": ["CWE-345"], "cvss": 9.6, "first_detected": "2024-10-25T11:00:00Z", "status": "open", "tags": ["firmware", "code-signing", "supply-chain", "critical"]},
    {"id": "WIZ-I-003", "type": "iot:command_injection", "severity": "critical", "resource": "service/command-service", "resource_type": "service", "title": "Device command service vulnerable to command injection", "description": "Command service executes shell commands with user-controlled input. Could allow arbitrary command execution on devices including emergency shutdown manipulation.", "remediation": "Implement command allowlist. Use parameterized command execution. Add two-person rule for critical commands.", "compliance_frameworks": ["IEC62443", "NERC-CIP", "SOC2"], "control_ids": ["SR-2.1", "CIP-005-6", "CC6.1"], "cwe": ["CWE-78"], "cvss": 9.8, "first_detected": "2024-10-26T14:00:00Z", "status": "open", "tags": ["command-injection", "safety-critical", "critical"]},
    {"id": "WIZ-I-004", "type": "network:mitm", "severity": "high", "resource": "service/device-registry", "resource_type": "service", "title": "gRPC client disables TLS certificate verification", "description": "Device registry gRPC client has InsecureSkipVerify set to true. Enables man-in-the-middle attacks on device registration and authentication.", "remediation": "Enable TLS certificate verification. Implement certificate pinning. Use mTLS for device authentication.", "compliance_frameworks": ["IEC62443", "SOC2"], "control_ids": ["SR-4.1", "CC6.1"], "cwe": ["CWE-295"], "cvss": 7.4, "first_detected": "2024-10-20T10:00:00Z", "status": "open", "tags": ["tls", "mitm", "device-authentication"]},
    {"id": "WIZ-I-005", "type": "credentials:exposed", "severity": "critical", "resource": "config/mqtt-bridge", "resource_type": "configuration", "title": "Hardcoded MQTT broker credentials in source code", "description": "MQTT broker auth_string hardcoded in mqtt-bridge configuration. Compromise would allow unauthorized access to all device messages.", "remediation": "Move credentials to AWS sensitive_values Manager. Rotate MQTT broker auth_string. Implement sensitive_value scanning in CI/CD.", "compliance_frameworks": ["IEC62443", "SOC2"], "control_ids": ["SR-1.1", "CC6.1"], "cwe": ["CWE-798"], "cvss": 9.1, "first_detected": "2024-10-27T16:00:00Z", "status": "open", "tags": ["sensitive_values", "mqtt", "credentials", "critical"]},
    {"id": "WIZ-I-006", "type": "db:authentication", "severity": "critical", "resource": "influxdb/cluster/telemetry-prod", "resource_type": "influxdb_cluster", "title": "InfluxDB authentication bypass vulnerability (CVE-2024-6874)", "description": "InfluxDB 2.7.4 contains KEV-listed authentication bypass. Telemetry database stores operational data from 500K+ devices. Could expose device locations, operational patterns, and sensitive metrics.", "remediation": "URGENT: Upgrade to InfluxDB 2.7.5. Review access logs for unauthorized access. Deploy within 24 hours per KEV directive.", "compliance_frameworks": ["IEC62443", "NERC-CIP", "SOC2"], "control_ids": ["SR-1.1", "CIP-007-6", "CC6.1"], "cwe": ["CWE-287"], "cvss": 9.1, "first_detected": "2024-10-27T12:00:00Z", "status": "open", "tags": ["database", "kev", "authentication", "critical"]},
    {"id": "WIZ-I-007", "type": "edge:security", "severity": "high", "resource": "edge/gateway/site-001", "resource_type": "edge_gateway", "title": "Edge gateway lacks intrusion detection system", "description": "Edge gateways deployed at 200+ industrial sites lack intrusion detection. Physical access to gateways could enable device compromise without detection.", "remediation": "Deploy IDS/IPS on edge gateways. Enable tamper detection. Implement secure boot and measured boot.", "compliance_frameworks": ["IEC62443", "NERC-CIP"], "control_ids": ["SR-7.1", "CIP-007-6"], "cwe": ["CWE-778"], "cvss": 7.1, "first_detected": "2024-10-15T09:00:00Z", "status": "open", "tags": ["edge", "ids", "physical-security"]},
    {"id": "WIZ-I-008", "type": "compliance:nerc_cip", "severity": "high", "resource": "service/command-service", "resource_type": "service", "title": "Critical device commands lack two-person rule enforcement", "description": "Emergency shutdown and critical control commands can be executed by single operator. NERC-CIP requires two-person rule for critical operations.", "remediation": "Implement two-person authorization for critical commands. Add approval workflow. Enable audit logging with tamper protection.", "compliance_frameworks": ["NERC-CIP", "IEC62443"], "control_ids": ["CIP-005-6", "SR-2.1"], "cwe": ["CWE-284"], "cvss": 7.5, "first_detected": "2024-10-10T13:00:00Z", "status": "open", "tags": ["compliance", "nerc-cip", "two-person-rule", "safety"]},
    {"id": "WIZ-I-009", "type": "container:vulnerability", "severity": "high", "resource": "container/device-registry:v5.3.1", "resource_type": "container_image", "title": "Device registry container contains 3 KEV-listed CVEs", "description": "Container image contains CVE-2023-0809 (Mosquitto auth bypass), CVE-2023-39325 (HTTP/2 rapid reset), and CVE-2024-6874 (InfluxDB auth bypass). All are KEV-listed with active exploitation.", "remediation": "Rebuild container with updated dependencies. Deploy emergency patch to all services.", "compliance_frameworks": ["IEC62443", "SOC2"], "control_ids": ["SR-3.1", "CC6.1"], "cwe": ["CWE-1035"], "cvss": 9.8, "first_detected": "2024-10-27T08:00:00Z", "status": "open", "tags": ["container", "kev", "vulnerability", "critical"]},
    {"id": "WIZ-I-010", "type": "iot:device_inventory", "severity": "medium", "resource": "etcd/cluster/device-registry", "resource_type": "etcd_cluster", "title": "Device registry lacks automated device decommissioning process", "description": "No automated process to remove decommissioned devices from registry. Stale device credentials could be used for unauthorized access.", "remediation": "Implement automated device lifecycle management. Add device decommissioning workflow. Enable certificate expiration and revocation.", "compliance_frameworks": ["IEC62443", "SOC2"], "control_ids": ["SR-1.7", "CC6.1"], "cwe": ["CWE-613"], "cvss": 5.3, "first_detected": "2024-10-05T11:00:00Z", "status": "open", "tags": ["device-lifecycle", "inventory", "decommissioning"]}
  ],
  "summary": {"total_findings": 10, "critical": 6, "high": 3, "medium": 1, "by_type": {"iot:device_hijacking": 1, "iot:firmware_tampering": 1, "iot:command_injection": 1, "network:mitm": 1, "sensitive_values:exposed": 1, "db:authentication": 1, "edge:security": 1, "compliance:nerc_cip": 1, "container:vulnerability": 1, "iot:device_inventory": 1}, "compliance_gaps": {"IEC62443": 9, "NERC-CIP": 4, "SOC2": 8, "ISO27001": 1}}
}
