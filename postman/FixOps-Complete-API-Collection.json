{
  "info": {
    "name": "FixOps Complete API Collection",
    "description": "Comprehensive API collection for FixOps - all main endpoints with real CVE test cases. Token: demo-token",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "apikey",
    "apikey": [
      {"key": "key", "value": "X-API-Key", "type": "string"},
      {"key": "value", "value": "demo-token", "type": "string"},
      {"key": "in", "value": "header", "type": "string"}
    ]
  },
  "variable": [
    {"key": "baseUrl", "value": "http://localhost:8000", "type": "string"},
    {"key": "apiToken", "value": "demo-token", "type": "string"}
  ],
  "item": [
    {
      "name": "Health & Status",
      "item": [
        {"name": "Health Check", "request": {"method": "GET", "url": "{{baseUrl}}/health"}},
        {"name": "Ready Check", "request": {"method": "GET", "url": "{{baseUrl}}/ready"}},
        {"name": "Version", "request": {"method": "GET", "url": "{{baseUrl}}/version"}},
        {"name": "API Status", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/status"}}
      ]
    },
    {
      "name": "Enhanced API (CVE Analysis)",
      "item": [
        {"name": "Get Capabilities", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/enhanced/capabilities"}},
        {"name": "Analyze CVE-2021-44228 (Log4Shell)", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/enhanced/analysis", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"service_name\":\"payment-service\",\"security_findings\":[{\"rule_id\":\"CVE-2021-44228\",\"severity\":\"critical\",\"description\":\"Apache Log4j2 RCE vulnerability (Log4Shell)\"}],\"business_context\":{\"environment\":\"production\",\"criticality\":\"high\"}}"}}},
        {"name": "Analyze CVE-2023-44487 (HTTP/2 Rapid Reset)", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/enhanced/analysis", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"service_name\":\"api-gateway\",\"security_findings\":[{\"rule_id\":\"CVE-2023-44487\",\"severity\":\"high\",\"description\":\"HTTP/2 Rapid Reset Attack DoS\"}],\"business_context\":{\"environment\":\"production\",\"criticality\":\"high\"}}"}}},
        {"name": "Analyze CVE-2024-3094 (XZ Backdoor)", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/enhanced/analysis", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"service_name\":\"linux-server\",\"security_findings\":[{\"rule_id\":\"CVE-2024-3094\",\"severity\":\"critical\",\"description\":\"XZ Utils backdoor supply chain attack\"}],\"business_context\":{\"environment\":\"production\",\"criticality\":\"critical\"}}"}}},
        {"name": "Compare LLMs", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/enhanced/compare-llms", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"service_name\":\"web-app\",\"security_findings\":[{\"rule_id\":\"CVE-2021-44228\",\"severity\":\"critical\",\"description\":\"Log4Shell\"},{\"rule_id\":\"CVE-2023-22515\",\"severity\":\"critical\",\"description\":\"Confluence Auth Bypass\"}],\"business_context\":{\"environment\":\"production\",\"criticality\":\"high\"}}"}}},
        {"name": "Get Signals", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/enhanced/signals?verdict=review&confidence=0.75"}}
      ]
    },
    {
      "name": "Pipeline & Inputs",
      "item": [
        {"name": "Run Pipeline", "request": {"method": "GET", "url": "{{baseUrl}}/pipeline/run"}},
        {"name": "Upload SBOM", "request": {"method": "POST", "url": "{{baseUrl}}/inputs/sbom", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"bomFormat\":\"CycloneDX\",\"specVersion\":\"1.4\",\"components\":[{\"type\":\"library\",\"name\":\"log4j-core\",\"version\":\"2.14.1\",\"purl\":\"pkg:maven/org.apache.logging.log4j/log4j-core@2.14.1\"}]}"}}},
        {"name": "Upload CVE Data", "request": {"method": "POST", "url": "{{baseUrl}}/inputs/cve", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"cves\":[{\"id\":\"CVE-2021-44228\",\"severity\":\"CRITICAL\",\"cvss\":10.0,\"description\":\"Log4Shell RCE\",\"affected_packages\":[\"log4j-core\"]}]}"}}},
        {"name": "Upload SARIF", "request": {"method": "POST", "url": "{{baseUrl}}/inputs/sarif", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"version\":\"2.1.0\",\"runs\":[{\"tool\":{\"driver\":{\"name\":\"Scanner\"}},\"results\":[{\"ruleId\":\"SQL_INJECTION\",\"level\":\"error\",\"message\":{\"text\":\"SQL Injection\"}}]}]}"}}},
        {"name": "Upload Design", "request": {"method": "POST", "url": "{{baseUrl}}/inputs/design", "header": [{"key": "Content-Type", "value": "text/csv"}], "body": {"mode": "raw", "raw": "component,type,exposure\npayment-api,service,internet-facing"}}},
        {"name": "Upload Context", "request": {"method": "POST", "url": "{{baseUrl}}/inputs/context", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"application_name\":\"ecommerce\",\"compliance_requirements\":[\"PCI-DSS\"],\"internet_facing\":true}"}}}
      ]
    },
    {
      "name": "Analytics & Dashboard",
      "item": [
        {"name": "Dashboard Overview", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/analytics/dashboard/overview"}},
        {"name": "Dashboard Trends", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/analytics/dashboard/trends"}},
        {"name": "Top Risks", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/analytics/dashboard/top-risks"}},
        {"name": "Compliance Status", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/analytics/dashboard/compliance-status"}},
        {"name": "MTTR Metrics", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/analytics/mttr"}},
        {"name": "Coverage", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/analytics/coverage"}},
        {"name": "ROI", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/analytics/roi"}},
        {"name": "Noise Reduction", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/analytics/noise-reduction"}},
        {"name": "List Findings", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/analytics/findings"}},
        {"name": "Create Finding", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/analytics/findings", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"title\":\"SQL Injection\",\"severity\":\"critical\",\"status\":\"open\",\"source\":\"sast\"}"}}},
        {"name": "List Decisions", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/analytics/decisions"}},
        {"name": "Export", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/analytics/export?format=json"}}
      ]
    },
    {
      "name": "Triage & Graph",
      "item": [
        {"name": "Get Triage", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/triage"}},
        {"name": "Export Triage", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/triage/export"}},
        {"name": "Risk Graph", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/graph"}}
      ]
    },
    {
      "name": "Workflows",
      "item": [
        {"name": "List Workflows", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/workflows"}},
        {"name": "Create Workflow", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/workflows", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"name\":\"CVE Response\",\"description\":\"Auto triage critical CVEs\",\"steps\":[{\"name\":\"scan\",\"action\":\"run_scan\"}]}"}}},
        {"name": "Get Workflow", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/workflows/{{workflowId}}"}},
        {"name": "Execute Workflow", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/workflows/{{workflowId}}/execute", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"trigger_data\":{\"cve_id\":\"CVE-2021-44228\"}}"}}},
        {"name": "Workflow History", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/workflows/{{workflowId}}/history"}}
      ]
    },
    {
      "name": "Pentagi (Pen Testing)",
      "item": [
        {"name": "List Requests", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/pentagi/requests"}},
        {"name": "Create Request", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/pentagi/requests", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"target\":\"https://api.example.com\",\"scope\":[\"auth\",\"injection\"],\"cves_to_test\":[\"CVE-2021-44228\"]}"}}},
        {"name": "Get Request", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/pentagi/requests/{{requestId}}"}},
        {"name": "Start Pentest", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/pentagi/requests/{{requestId}}/start"}},
        {"name": "List Results", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/pentagi/results"}},
        {"name": "Get Stats", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/pentagi/stats"}},
        {"name": "Comprehensive Scan", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/pentagi/scan/comprehensive", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"target\":\"https://app.example.com\",\"scan_types\":[\"sast\",\"dast\",\"sca\"],\"include_cves\":[\"CVE-2021-44228\"]}"}}},
        {"name": "Verify Finding", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/pentagi/verify", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"finding_id\":\"finding-001\",\"verification_type\":\"exploit\",\"safe_mode\":true}"}}},
        {"name": "List Configs", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/pentagi/configs"}}
      ]
    },
    {
      "name": "Users & Teams",
      "item": [
        {"name": "Login", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/users/login", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"username\":\"admin\",\"password\":\"admin123\"}"}}},
        {"name": "List Users", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/users"}},
        {"name": "Create User", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/users", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"username\":\"analyst\",\"email\":\"analyst@example.com\",\"role\":\"analyst\"}"}}},
        {"name": "List Teams", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/teams"}},
        {"name": "Create Team", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/teams", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"name\":\"Security Ops\",\"description\":\"SOC team\"}"}}}
      ]
    },
    {
      "name": "Policies",
      "item": [
        {"name": "List Policies", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/policies"}},
        {"name": "Create Policy", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/policies", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"name\":\"Block Critical CVEs\",\"rules\":[{\"condition\":\"severity == critical\",\"action\":\"block\"}]}"}}},
        {"name": "Validate Policy", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/policies/{{policyId}}/validate"}},
        {"name": "Test Policy", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/policies/{{policyId}}/test", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"test_data\":{\"cve_id\":\"CVE-2021-44228\",\"severity\":\"critical\"}}"}}}
      ]
    },
    {
      "name": "Reports",
      "item": [
        {"name": "List Reports", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/reports"}},
        {"name": "Create Report", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/reports", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"name\":\"Weekly Summary\",\"type\":\"executive\",\"format\":\"pdf\"}"}}},
        {"name": "Download Report", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/reports/{{reportId}}/download"}},
        {"name": "Schedule Report", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/reports/schedule", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"name\":\"Daily CVE Report\",\"schedule\":\"0 9 * * *\",\"recipients\":[\"security@example.com\"]}"}}},
        {"name": "Export SARIF", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/reports/export/sarif", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"filters\":{\"severity\":[\"critical\"]}}"}}},
        {"name": "Export CSV", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/reports/export/csv", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"filters\":{\"status\":[\"open\"]}}"}}}
      ]
    },
    {
      "name": "Integrations",
      "item": [
        {"name": "List Integrations", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/integrations"}},
        {"name": "Create Jira", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/integrations", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"name\":\"Jira\",\"type\":\"jira\",\"config\":{\"base_url\":\"https://company.atlassian.net\",\"project_key\":\"SEC\"}}"}}},
        {"name": "Create Slack", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/integrations", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"name\":\"Slack\",\"type\":\"slack\",\"config\":{\"channel\":\"#security-alerts\"}}"}}},
        {"name": "Test Integration", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/integrations/{{integrationId}}/test"}},
        {"name": "Sync", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/integrations/{{integrationId}}/sync"}}
      ]
    },
    {
      "name": "Inventory",
      "item": [
        {"name": "List Applications", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/inventory/applications"}},
        {"name": "Create Application", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/inventory/applications", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"name\":\"Payment Gateway\",\"criticality\":\"critical\",\"tech_stack\":[\"java\",\"spring\"]}"}}},
        {"name": "Get Components", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/inventory/applications/{{applicationId}}/components"}},
        {"name": "Get Dependencies", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/inventory/applications/{{applicationId}}/dependencies"}},
        {"name": "List Services", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/inventory/services"}},
        {"name": "Search", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/inventory/search?q=payment"}}
      ]
    },
    {
      "name": "Secrets Detection",
      "item": [
        {"name": "List Secrets", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/secrets"}},
        {"name": "Create Finding", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/secrets", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"type\":\"aws_access_key\",\"file_path\":\"config.py\",\"severity\":\"critical\"}"}}},
        {"name": "Resolve", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/secrets/{{secretId}}/resolve", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"resolution\":\"rotated\"}"}}},
        {"name": "Scan", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/secrets/scan", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"repository\":\"https://github.com/org/repo\"}"}}}
      ]
    },
    {
      "name": "IaC Security",
      "item": [
        {"name": "List IaC", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/iac"}},
        {"name": "Create Finding", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/iac", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"type\":\"terraform\",\"rule_id\":\"AWS_S3_PUBLIC\",\"severity\":\"high\"}"}}},
        {"name": "Resolve", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/iac/{{iacId}}/resolve", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"resolution\":\"fixed\"}"}}},
        {"name": "Scan", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/iac/scan", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"repository\":\"https://github.com/org/infra\",\"frameworks\":[\"terraform\"]}"}}}
      ]
    },
    {
      "name": "IDE Integration",
      "item": [
        {"name": "Get Config", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/ide/config"}},
        {"name": "Analyze Code", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/ide/analyze", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"file_path\":\"login.py\",\"content\":\"query = f\\\"SELECT * FROM users WHERE user='{user}'\\\"\"}"}}},
        {"name": "Get Suggestions", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/ide/suggestions?file_path=login.py"}}
      ]
    },
    {
      "name": "Audit & Compliance",
      "item": [
        {"name": "List Logs", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/audit/logs"}},
        {"name": "User Activity", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/audit/user-activity"}},
        {"name": "Policy Changes", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/audit/policy-changes"}},
        {"name": "Decision Trail", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/audit/decision-trail"}},
        {"name": "List Frameworks", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/audit/compliance/frameworks"}},
        {"name": "Framework Status", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/audit/compliance/frameworks/{{frameworkId}}/status"}},
        {"name": "Framework Gaps", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/audit/compliance/frameworks/{{frameworkId}}/gaps"}}
      ]
    },
    {
      "name": "Bulk Operations",
      "item": [
        {"name": "Bulk Update", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/bulk/findings/update", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"finding_ids\":[\"f1\",\"f2\"],\"updates\":{\"status\":\"in_progress\"}}"}}},
        {"name": "Bulk Delete", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/bulk/findings/delete", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"finding_ids\":[\"old1\",\"old2\"]}"}}},
        {"name": "Bulk Assign", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/bulk/findings/assign", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"finding_ids\":[\"f1\"],\"assignee\":\"team\"}"}}},
        {"name": "Bulk Export", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/bulk/export", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"entity_type\":\"findings\",\"format\":\"csv\"}"}}}
      ]
    },
    {
      "name": "SSO & Auth",
      "item": [
        {"name": "List SSO", "request": {"method": "GET", "url": "{{baseUrl}}/api/v1/auth/sso"}},
        {"name": "Create SSO", "request": {"method": "POST", "url": "{{baseUrl}}/api/v1/auth/sso", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"name\":\"Okta\",\"provider\":\"okta\",\"config\":{\"issuer\":\"https://company.okta.com\"}}"}}}
      ]
    },
    {
      "name": "Feedback",
      "item": [
        {"name": "Submit Feedback", "request": {"method": "POST", "url": "{{baseUrl}}/feedback", "header": [{"key": "Content-Type", "value": "application/json"}], "body": {"mode": "raw", "raw": "{\"finding_id\":\"f1\",\"feedback_type\":\"false_positive\",\"reason\":\"Test code\"}"}}}
      ]
    }
  ]
}
