[SERVICE]
    Flush        ${AGGREGATION_INTERVAL}
    Daemon       Off
    Log_Level    info
    Parsers_File parsers.conf

[INPUT]
    Name              tail
    Path              ${INPUT_PATH}
    Parser            json
    Tag               waf.logs
    Refresh_Interval  5
    Mem_Buf_Limit     50MB
    Skip_Long_Lines   On

[FILTER]
    Name    lua
    Match   waf.logs
    script  aggregate.lua
    call    aggregate_waf_logs

[OUTPUT]
    Name          http
    Match         waf.logs
    Host          collector-api
    Port          8080
    URI           /telemetry
    Format        json
    Retry_Limit   ${RETRY_LIMIT}
    tls           Off
