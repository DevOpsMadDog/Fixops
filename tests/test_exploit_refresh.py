from core import exploit_signals


def test_refresh_exploit_feeds(monkeypatch):
    calls = []

    def _kev(_: exploit_signals.OverlayConfig | None = None):
        calls.append("kev")
        return {"status": "refreshed"}

    def _epss(_: exploit_signals.OverlayConfig | None = None):
        calls.append("epss")
        return {"status": "refreshed"}

    monkeypatch.setattr(exploit_signals, "load_latest_kev_feed", _kev)
    monkeypatch.setattr(exploit_signals, "load_latest_epss_feed", _epss)

    exploit_signals.refresh_exploit_feeds()
    assert calls == ["kev", "epss"]
