{
  "policy_id": "sec-policy-prod-001",
  "name": "Production Security Policy",
  "version": "2.0.0",
  "description": "Security policy for production deployments",
  "status": "active",
  "scope": {
    "environments": ["production"],
    "applications": ["*"],
    "teams": ["*"]
  },
  "effective_date": "2025-01-01",
  "review_date": "2025-07-01",
  "owner": "security-team@example.com",
  "rules": [
    {
      "rule_id": "VULN-CRITICAL-001",
      "name": "Block Critical Vulnerabilities",
      "description": "No critical vulnerabilities allowed in production",
      "category": "vulnerability",
      "severity": "blocking",
      "condition": {
        "type": "vulnerability_count",
        "severity": "critical",
        "operator": "equals",
        "value": 0
      },
      "action": "block_deployment",
      "message": "Deployment blocked: Critical vulnerabilities detected"
    },
    {
      "rule_id": "VULN-HIGH-001",
      "name": "Limit High Vulnerabilities",
      "description": "Maximum 5 high severity vulnerabilities",
      "category": "vulnerability",
      "severity": "blocking",
      "condition": {
        "type": "vulnerability_count",
        "severity": "high",
        "operator": "less_than_or_equal",
        "value": 5
      },
      "action": "block_deployment",
      "message": "Deployment blocked: Too many high severity vulnerabilities"
    },
    {
      "rule_id": "KEV-001",
      "name": "Block KEV Vulnerabilities",
      "description": "No CISA KEV listed vulnerabilities allowed",
      "category": "vulnerability",
      "severity": "blocking",
      "condition": {
        "type": "kev_count",
        "operator": "equals",
        "value": 0
      },
      "action": "block_deployment",
      "message": "Deployment blocked: Known Exploited Vulnerability detected"
    },
    {
      "rule_id": "LICENSE-001",
      "name": "Approved Licenses Only",
      "description": "Only approved open source licenses allowed",
      "category": "license",
      "severity": "blocking",
      "condition": {
        "type": "license_check",
        "allowed": ["MIT", "Apache-2.0", "BSD-2-Clause", "BSD-3-Clause", "ISC"],
        "denied": ["GPL-3.0", "AGPL-3.0", "SSPL"]
      },
      "action": "block_deployment",
      "message": "Deployment blocked: Unapproved license detected"
    },
    {
      "rule_id": "SBOM-001",
      "name": "SBOM Required",
      "description": "Valid SBOM must be present",
      "category": "compliance",
      "severity": "blocking",
      "condition": {
        "type": "sbom_present",
        "format": ["cyclonedx", "spdx"],
        "valid": true
      },
      "action": "block_deployment",
      "message": "Deployment blocked: Valid SBOM required"
    },
    {
      "rule_id": "SIGN-001",
      "name": "Image Signing Required",
      "description": "Container images must be signed",
      "category": "supply_chain",
      "severity": "blocking",
      "condition": {
        "type": "image_signed",
        "key_id": "cosign-prod-key"
      },
      "action": "block_deployment",
      "message": "Deployment blocked: Image signature verification failed"
    },
    {
      "rule_id": "SECRET-001",
      "name": "No Hardcoded Secrets",
      "description": "No secrets in source code or images",
      "category": "secrets",
      "severity": "blocking",
      "condition": {
        "type": "secrets_scan",
        "detected": false
      },
      "action": "block_deployment",
      "message": "Deployment blocked: Hardcoded secrets detected"
    },
    {
      "rule_id": "AGE-001",
      "name": "Base Image Age Limit",
      "description": "Base images must be less than 30 days old",
      "category": "supply_chain",
      "severity": "warning",
      "condition": {
        "type": "image_age",
        "max_days": 30
      },
      "action": "warn",
      "message": "Warning: Base image is older than 30 days"
    }
  ],
  "exceptions": {
    "allow_temporary": true,
    "max_duration_days": 30,
    "require_approval": true,
    "approvers": ["security-team", "ciso"]
  },
  "notifications": {
    "on_block": ["security-team@example.com", "slack:#security-alerts"],
    "on_warn": ["team-leads@example.com"],
    "on_exception": ["security-team@example.com", "audit@example.com"]
  }
}
