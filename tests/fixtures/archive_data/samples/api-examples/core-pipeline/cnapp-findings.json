{
  "scan_id": "cnapp-scan-2025-01-15-001",
  "scan_timestamp": "2025-01-15T10:30:00Z",
  "scanner": {
    "name": "CloudSecurityScanner",
    "version": "3.5.0",
    "vendor": "Example Security"
  },
  "environment": {
    "cloud_provider": "aws",
    "account_id": "123456789012",
    "region": "us-east-1",
    "cluster_name": "production-eks"
  },
  "findings": [
    {
      "id": "CNAPP-001",
      "title": "Container running as root",
      "severity": "high",
      "category": "container_security",
      "description": "Container 'payment-api' is running with root privileges, which increases the attack surface",
      "resource": {
        "type": "kubernetes_pod",
        "name": "payment-api-7d8f9c6b5-x2k4m",
        "namespace": "production",
        "cluster": "production-eks"
      },
      "remediation": "Set securityContext.runAsNonRoot: true and specify a non-root user",
      "compliance": ["CIS-Kubernetes-1.8", "PCI-DSS-2.2.4"],
      "evidence": {
        "container_user": "root",
        "security_context": null
      }
    },
    {
      "id": "CNAPP-002",
      "title": "Privileged container detected",
      "severity": "critical",
      "category": "container_security",
      "description": "Container 'debug-tools' is running in privileged mode with full host access",
      "resource": {
        "type": "kubernetes_pod",
        "name": "debug-tools-5c4d3b2a1-y7z8w",
        "namespace": "kube-system",
        "cluster": "production-eks"
      },
      "remediation": "Remove privileged: true from container security context. Use specific capabilities instead.",
      "compliance": ["CIS-Kubernetes-5.2.1", "NIST-800-190"],
      "evidence": {
        "privileged": true,
        "capabilities": ["ALL"]
      }
    },
    {
      "id": "CNAPP-003",
      "title": "S3 bucket publicly accessible",
      "severity": "critical",
      "category": "cloud_storage",
      "description": "S3 bucket 'payment-logs-prod' has public read access enabled",
      "resource": {
        "type": "aws_s3_bucket",
        "name": "payment-logs-prod",
        "arn": "arn:aws:s3:::payment-logs-prod",
        "region": "us-east-1"
      },
      "remediation": "Disable public access and enable S3 Block Public Access settings",
      "compliance": ["CIS-AWS-2.1.5", "SOC2-CC6.1", "PCI-DSS-7.1"],
      "evidence": {
        "public_access_block": false,
        "bucket_acl": "public-read"
      }
    },
    {
      "id": "CNAPP-004",
      "title": "Unencrypted EBS volume",
      "severity": "medium",
      "category": "data_protection",
      "description": "EBS volume attached to production instance is not encrypted",
      "resource": {
        "type": "aws_ebs_volume",
        "name": "vol-0abc123def456789",
        "region": "us-east-1",
        "attached_to": "i-0123456789abcdef0"
      },
      "remediation": "Enable EBS encryption by default and migrate existing volumes to encrypted snapshots",
      "compliance": ["CIS-AWS-2.2.1", "HIPAA-164.312(a)(2)(iv)"],
      "evidence": {
        "encrypted": false,
        "size_gb": 100
      }
    },
    {
      "id": "CNAPP-005",
      "title": "Security group allows unrestricted SSH",
      "severity": "high",
      "category": "network_security",
      "description": "Security group allows SSH access from 0.0.0.0/0",
      "resource": {
        "type": "aws_security_group",
        "name": "sg-0123456789abcdef0",
        "vpc_id": "vpc-0abc123def456789"
      },
      "remediation": "Restrict SSH access to specific IP ranges or use AWS Systems Manager Session Manager",
      "compliance": ["CIS-AWS-5.2", "PCI-DSS-1.3.1"],
      "evidence": {
        "ingress_rules": [
          {"port": 22, "protocol": "tcp", "cidr": "0.0.0.0/0"}
        ]
      }
    }
  ],
  "summary": {
    "total_findings": 5,
    "by_severity": {
      "critical": 2,
      "high": 2,
      "medium": 1,
      "low": 0
    },
    "by_category": {
      "container_security": 2,
      "cloud_storage": 1,
      "data_protection": 1,
      "network_security": 1
    }
  }
}
