{
  "scan_id": "orca-2025-001",
  "tool": "orca-security",
  "tool_version": "2024.12",
  "scan_type": "cloud",
  "timestamp": "2025-01-15T19:00:00Z",
  "organization": "example-corp",
  "cloud_accounts": [
    {"provider": "aws", "account_id": "123456789012", "name": "Production"},
    {"provider": "aws", "account_id": "987654321098", "name": "Staging"}
  ],
  "alerts": [
    {
      "id": "orca-alert-pay-001",
      "title": "Publicly accessible S3 bucket with sensitive data",
      "category": "Data at Risk",
      "severity": "critical",
      "status": "open",
      "asset": {
        "type": "S3Bucket",
        "name": "payment-gateway-backups",
        "cloud_provider": "aws",
        "account": "123456789012",
        "region": "us-east-1"
      },
      "details": {
        "issue": "S3 bucket has public read access and contains database backups",
        "data_found": ["credit_card_numbers", "cvv", "transaction_logs"],
        "acl": "public-read",
        "bucket_policy": "allows s3:GetObject from *"
      },
      "compliance": ["PCI-DSS 3.4", "PCI-DSS 7.1"],
      "remediation": {
        "description": "Remove public access and enable encryption",
        "steps": [
          "Block public access at bucket level",
          "Remove public ACL",
          "Enable SSE-KMS encryption",
          "Enable access logging"
        ]
      },
      "correlation_id": "CORR-S3-002",
      "application": "payment-gateway"
    },
    {
      "id": "orca-alert-iam-001",
      "title": "Exposed secrets in container environment",
      "category": "Secrets",
      "severity": "critical",
      "status": "open",
      "asset": {
        "type": "Container",
        "name": "user-identity-service",
        "cloud_provider": "aws",
        "account": "123456789012",
        "region": "us-east-1",
        "cluster": "prod-eks-identity"
      },
      "details": {
        "secrets_found": [
          {"type": "JWT_SECRET", "location": "environment variable"},
          {"type": "DATABASE_PASSWORD", "location": "environment variable"},
          {"type": "OKTA_API_TOKEN", "location": "environment variable"}
        ]
      },
      "compliance": ["SOC2 CC6.1", "GDPR Art.32"],
      "remediation": {
        "description": "Move secrets to AWS Secrets Manager",
        "steps": [
          "Create secrets in AWS Secrets Manager",
          "Update deployment to use secretRef",
          "Remove plaintext environment variables",
          "Rotate compromised credentials"
        ]
      },
      "correlation_id": "CORR-SECRET-002",
      "application": "user-identity-service"
    },
    {
      "id": "orca-alert-health-001",
      "title": "Lateral movement risk from compromised healthcare workload",
      "category": "Lateral Movement",
      "severity": "high",
      "status": "open",
      "asset": {
        "type": "EC2Instance",
        "name": "healthcare-api-node-1",
        "cloud_provider": "aws",
        "account": "123456789012",
        "region": "us-east-1"
      },
      "details": {
        "issue": "Instance has IAM role with excessive permissions",
        "permissions": ["ec2:*", "s3:*", "rds:*", "secretsmanager:*"],
        "reachable_resources": ["healthcare-db-prod", "patient-records-bucket", "all-secrets"]
      },
      "compliance": ["HIPAA 164.312(a)(1)", "HIPAA 164.308(a)(4)"],
      "remediation": {
        "description": "Apply least privilege to IAM role",
        "steps": [
          "Audit current permission usage with IAM Access Analyzer",
          "Create minimal policy based on actual usage",
          "Replace overly permissive role",
          "Enable CloudTrail for monitoring"
        ]
      },
      "correlation_id": "CORR-LATERAL-001",
      "application": "healthcare-api"
    },
    {
      "id": "orca-alert-supply-001",
      "title": "Vulnerable third-party library in production",
      "category": "Vulnerabilities",
      "severity": "high",
      "status": "open",
      "asset": {
        "type": "Container",
        "name": "supply-chain-portal",
        "cloud_provider": "aws",
        "account": "123456789012",
        "region": "eu-west-1",
        "cluster": "prod-eks-supply"
      },
      "details": {
        "vulnerability": "CVE-2024-23829",
        "package": "celery",
        "version": "5.2.7",
        "fixed_version": "5.3.5",
        "cvss": 9.8,
        "exploit_available": true
      },
      "compliance": ["SOC2 CC7.1", "ISO27001 A.12.6.1"],
      "remediation": {
        "description": "Upgrade Celery to patched version",
        "steps": [
          "Update requirements.txt to celery>=5.3.5",
          "Run security tests",
          "Deploy updated container",
          "Verify fix in production"
        ]
      },
      "correlation_id": "CORR-CELERY-001",
      "application": "supply-chain-portal"
    }
  ],
  "risk_score": {
    "overall": 85,
    "by_category": {
      "data_at_risk": 95,
      "vulnerabilities": 80,
      "misconfigurations": 75,
      "lateral_movement": 85,
      "secrets": 90
    }
  },
  "summary": {
    "total_alerts": 4,
    "critical": 2,
    "high": 2,
    "medium": 0,
    "low": 0
  }
}
