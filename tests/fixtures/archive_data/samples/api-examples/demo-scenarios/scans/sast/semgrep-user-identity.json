{
  "scan_id": "semgrep-iam-2025-001",
  "tool": "semgrep",
  "tool_version": "1.50.0",
  "scan_type": "sast",
  "timestamp": "2025-01-15T09:00:00Z",
  "application": "user-identity-service",
  "branch": "main",
  "commit": "def456ghi789",
  "rules_used": ["p/python", "p/security-audit", "p/owasp-top-ten"],
  "findings": [
    {
      "id": "SEMGREP-IAM-001",
      "check_id": "python.django.security.injection.sql.sql-injection-using-raw",
      "title": "SQL Injection via raw query",
      "severity": "critical",
      "cwe": "CWE-89",
      "owasp": "A03:2021",
      "path": "src/identity/repositories/user_repository.py",
      "start_line": 78,
      "end_line": 80,
      "code": "cursor.execute(f\"SELECT * FROM users WHERE email = '{email}'\")",
      "message": "Detected SQL injection. Use parameterized queries instead.",
      "fix": "cursor.execute(\"SELECT * FROM users WHERE email = %s\", [email])",
      "metadata": {
        "confidence": "high",
        "likelihood": "high",
        "impact": "high"
      },
      "correlation_id": "CORR-SQL-002"
    },
    {
      "id": "SEMGREP-IAM-002",
      "check_id": "python.lang.security.audit.insecure-hash-algorithms.insecure-hash-algorithm-md5",
      "title": "Insecure hash algorithm MD5",
      "severity": "high",
      "cwe": "CWE-328",
      "owasp": "A02:2021",
      "path": "src/identity/services/password_service.py",
      "start_line": 45,
      "end_line": 45,
      "code": "hashlib.md5(password.encode()).hexdigest()",
      "message": "MD5 is cryptographically weak. Use bcrypt or argon2 for passwords.",
      "fix": "bcrypt.hashpw(password.encode(), bcrypt.gensalt())",
      "metadata": {
        "confidence": "high",
        "likelihood": "medium",
        "impact": "high"
      },
      "correlation_id": "CORR-CRYPTO-002"
    },
    {
      "id": "SEMGREP-IAM-003",
      "check_id": "python.jwt.security.jwt-hardcoded-secret",
      "title": "Hardcoded JWT secret",
      "severity": "critical",
      "cwe": "CWE-798",
      "owasp": "A07:2021",
      "path": "src/identity/auth/jwt_handler.py",
      "start_line": 12,
      "end_line": 12,
      "code": "JWT_SECRET = \"super_secret_key_12345\"",
      "message": "JWT secret is hardcoded. Use environment variable.",
      "fix": "JWT_SECRET = os.environ.get('JWT_SECRET')",
      "metadata": {
        "confidence": "high",
        "likelihood": "high",
        "impact": "critical"
      },
      "correlation_id": "CORR-CRED-002"
    },
    {
      "id": "SEMGREP-IAM-004",
      "check_id": "python.lang.security.audit.dangerous-system-call",
      "title": "Command injection via os.system",
      "severity": "critical",
      "cwe": "CWE-78",
      "owasp": "A03:2021",
      "path": "src/identity/utils/shell_utils.py",
      "start_line": 23,
      "end_line": 23,
      "code": "os.system(f\"echo {user_input}\")",
      "message": "User input in system call allows command injection",
      "fix": "Use subprocess.run with shell=False and argument list",
      "metadata": {
        "confidence": "high",
        "likelihood": "high",
        "impact": "critical"
      },
      "correlation_id": "CORR-CMD-001"
    },
    {
      "id": "SEMGREP-IAM-005",
      "check_id": "python.lang.security.audit.insecure-transport.requests-no-verify",
      "title": "SSL verification disabled",
      "severity": "medium",
      "cwe": "CWE-295",
      "owasp": "A07:2021",
      "path": "src/identity/integrations/okta_client.py",
      "start_line": 56,
      "end_line": 56,
      "code": "requests.get(url, verify=False)",
      "message": "SSL certificate verification is disabled",
      "fix": "Remove verify=False or set verify=True",
      "metadata": {
        "confidence": "high",
        "likelihood": "medium",
        "impact": "medium"
      },
      "correlation_id": "CORR-SSL-001"
    }
  ],
  "summary": {
    "total": 5,
    "critical": 3,
    "high": 1,
    "medium": 1,
    "low": 0
  }
}
