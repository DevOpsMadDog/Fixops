# Investor / CISO Demo Stack

Phase 9 adds end-to-end observability and a one-command demo environment for showcasing FixOps capabilities.

## Components

- **OpenTelemetry collector** (`otel/opentelemetry-collector`) receives traces/metrics from the API, graph worker, and CLI flows.
- **API** (`uvicorn apps.api.app:create_app`) with FastAPI instrumentation and trace spans emitted for provenance, risk, graph, and evidence routes.
- **Graph worker** (`scripts/graph_worker.py`) periodically rebuilds the provenance graph and publishes spans.
- **Dashboard** (`ui/dashboard/`) served via Nginx with live fetches against the API to render SBOM quality, risk posture, reproducibility, and evidence bundle status.

## Quick start

```bash
docker compose -f docker-compose.demo.yml up --build
```

Once the stack is healthy:

- API available at `http://localhost:8000/docs`
- Dashboard available at `http://localhost:8080`
- OTLP collector emits logs to the compose console (configured via `config/otel-collector-demo.yaml`)

The dashboard expects evidence bundles and manifests generated by `cli/fixops-ci evidence bundle`. Run the CLI before launching the demo or mount existing artefacts into the containers.

## Telemetry

The following spans/metrics are emitted:

| Component | Span prefix | Metrics |
| --- | --- | --- |
| Provenance attestation | `provenance.*` | `fixops_provenance_operations` counter |
| Graph service | `graph.*` | `fixops_graph_ingest`, `fixops_graph_queries` counters |
| Risk scoring | `risk.compute_profile` | `fixops_risk_profiles` counter |
| Repro verification | `repro.verify_plan` | `fixops_repro_verifications` counter |
| API server | automatic FastAPI instrumentation |

All services honour `OTEL_EXPORTER_OTLP_ENDPOINT` and can be disabled via `FIXOPS_DISABLE_TELEMETRY=1`.

## Dashboard data sources

- `GET /evidence/` + `GET /evidence/{tag}` provide metrics, evaluations, and bundle metadata.
- `GET /graph/kev-components?last=3` surfaces KEV exposure across recent releases.

The UI displays SBOM coverage as a gauge, risk summary counts, reproducibility status pills, and tabular KEV/evidence summaries.

## Next steps

- Point the collector at a real backend (Grafana Tempo/Prometheus) by editing `config/otel-collector-demo.yaml`.
- Add authentication for the dashboard via Nginx basic auth or OAuth proxies.
- Extend the graph worker to push notifications into Slack or SIEM tools when anomalies appear.
