{
  "$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json",
  "version": "2.1.0",
  "runs": [
    {
      "tool": {
        "driver": {
          "name": "Snyk Code",
          "version": "1.1045.0",
          "informationUri": "https://snyk.io/"
        }
      },
      "results": [
        {
          "ruleId": "javascript/ServerSideRequestForgery",
          "level": "error",
          "message": {
            "text": "Server-Side Request Forgery (SSRF) vulnerability. User-controlled URL is passed to HTTP request without validation, allowing access to internal network resources."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/services/imageProxy.js"
                },
                "region": {
                  "startLine": 28,
                  "startColumn": 15,
                  "snippet": {
                    "text": "const response = await axios.get(req.query.imageUrl);"
                  }
                }
              }
            }
          ],
          "properties": {
            "security-severity": "9.1",
            "tags": ["security", "ssrf", "cwe-918"]
          }
        },
        {
          "ruleId": "javascript/HardcodedSecret",
          "level": "error",
          "message": {
            "text": "Hardcoded secret detected. API key is stored directly in source code and committed to Git repository."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/config/partners.js"
                },
                "region": {
                  "startLine": 12,
                  "startColumn": 20,
                  "snippet": {
                    "text": "const PARTNER_API_KEY = 'pk_live_51HqJK2L3m4n5o6p7q8r9s0t1u2v3w4x';"
                  }
                }
              }
            }
          ],
          "properties": {
            "security-severity": "8.7",
            "tags": ["security", "credentials", "cwe-798"],
            "git_history": "Found in commits: a1b2c3d, e4f5g6h, i7j8k9l"
          }
        },
        {
          "ruleId": "javascript/XXE",
          "level": "error",
          "message": {
            "text": "XML External Entity (XXE) injection vulnerability. XML parser is configured to process external entities without validation."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/services/dataTransformer.js"
                },
                "region": {
                  "startLine": 45,
                  "startColumn": 25,
                  "snippet": {
                    "text": "xml2js.parseString(partnerData, { explicitRoot: true }, callback);"
                  }
                }
              }
            }
          ],
          "properties": {
            "security-severity": "7.8",
            "tags": ["security", "xxe", "cwe-611"]
          }
        },
        {
          "ruleId": "javascript/InsecureRandomness",
          "level": "warning",
          "message": {
            "text": "Cryptographically weak random number generator used for security-sensitive operations."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/auth/tokenGenerator.js"
                },
                "region": {
                  "startLine": 19,
                  "startColumn": 20,
                  "snippet": {
                    "text": "const token = Math.random().toString(36).substring(2);"
                  }
                }
              }
            }
          ],
          "properties": {
            "security-severity": "6.5",
            "tags": ["security", "randomness", "cwe-338"]
          }
        },
        {
          "ruleId": "javascript/MissingRateLimiting",
          "level": "warning",
          "message": {
            "text": "API endpoint lacks rate limiting, allowing potential denial of service attacks."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/routes/webhooks.js"
                },
                "region": {
                  "startLine": 34,
                  "startColumn": 10,
                  "snippet": {
                    "text": "router.post('/webhook', async (req, res) => {"
                  }
                }
              }
            }
          ],
          "properties": {
            "security-severity": "5.3",
            "tags": ["security", "rate-limiting", "cwe-770"]
          }
        },
        {
          "ruleId": "javascript/MissingHMACValidation",
          "level": "warning",
          "message": {
            "text": "Webhook endpoint does not verify HMAC signature, allowing spoofed requests."
          },
          "locations": [
            {
              "physicalLocation": {
                "artifactLocation": {
                  "uri": "src/routes/webhooks.js"
                },
                "region": {
                  "startLine": 35,
                  "startColumn": 5,
                  "snippet": {
                    "text": "const payload = req.body; // No signature verification"
                  }
                }
              }
            }
          ],
          "properties": {
            "security-severity": "6.8",
            "tags": ["security", "authentication", "cwe-345"]
          }
        }
      ]
    }
  ]
}
