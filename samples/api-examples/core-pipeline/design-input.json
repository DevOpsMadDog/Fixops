{
  "application_name": "payment-gateway",
  "version": "2.1.0",
  "description": "Secure payment processing microservice",
  "architecture": {
    "type": "microservice",
    "framework": "spring-boot",
    "language": "java",
    "runtime": "jvm-17"
  },
  "components": [
    {
      "name": "api-gateway",
      "type": "service",
      "exposure": "public",
      "protocols": ["https", "grpc"],
      "authentication": "oauth2",
      "data_classification": "pci-dss"
    },
    {
      "name": "payment-processor",
      "type": "service",
      "exposure": "internal",
      "protocols": ["grpc"],
      "authentication": "mtls",
      "data_classification": "pci-dss"
    },
    {
      "name": "transaction-db",
      "type": "database",
      "engine": "postgresql",
      "encryption": "aes-256",
      "data_classification": "pci-dss"
    }
  ],
  "data_flows": [
    {
      "source": "api-gateway",
      "destination": "payment-processor",
      "protocol": "grpc",
      "encrypted": true,
      "data_types": ["card_number", "cvv", "expiry"]
    },
    {
      "source": "payment-processor",
      "destination": "transaction-db",
      "protocol": "tcp",
      "encrypted": true,
      "data_types": ["transaction_id", "amount", "status"]
    }
  ],
  "security_controls": {
    "authentication": ["oauth2", "mtls"],
    "authorization": ["rbac", "abac"],
    "encryption": ["tls-1.3", "aes-256"],
    "logging": ["audit-trail", "security-events"],
    "monitoring": ["siem", "apm"]
  },
  "compliance_requirements": ["pci-dss", "soc2", "gdpr"],
  "threat_model": {
    "assets": ["cardholder_data", "transaction_records", "api_keys"],
    "threat_actors": ["external_attacker", "malicious_insider"],
    "attack_vectors": ["api_abuse", "sql_injection", "credential_stuffing"]
  }
}
