{
  "scan_time": "2025-10-28T12:15:00Z",
  "scanner": "Wiz CNAPP",
  "platform": "AWS",
  "account_id": "123456789012",
  "region": "us-east-1",
  "findings": [
    {
      "id": "CNAPP-001",
      "type": "k8s:misconfig",
      "severity": "critical",
      "resource": "namespace/production/service/customers-db",
      "resource_type": "kubernetes_service",
      "title": "PostgreSQL database service exposed via LoadBalancer with public IP",
      "description": "The customers-db PostgreSQL service is exposed to the internet via a LoadBalancer with a public IP address. This database contains PII/PHI data and should only be accessible from within the VPC.",
      "remediation": "Change service type from LoadBalancer to ClusterIP and access via internal ingress only",
      "compliance_violations": ["PCI-DSS 1.3.1", "HIPAA 164.312(a)(1)", "SOC2 CC6.1"],
      "risk_factors": {
        "internet_exposed": true,
        "contains_sensitive_data": true,
        "data_classification": ["pii", "phi", "financial"],
        "has_vulnerabilities": true,
        "missing_encryption": false,
        "environment": "production"
      },
      "affected_workloads": ["customers-db-primary", "customers-db-replica-1", "customers-db-replica-2"]
    },
    {
      "id": "CNAPP-002",
      "type": "iam:overprivileged",
      "severity": "high",
      "resource": "arn:aws:iam::123456789012:role/pricing-engine-role",
      "resource_type": "iam_role",
      "title": "Pricing engine IAM role has overly permissive S3 access",
      "description": "The pricing-engine-role has s3:* permissions on all buckets. This violates least privilege principle and could allow unauthorized access to sensitive policy documents.",
      "remediation": "Restrict S3 permissions to specific buckets and actions (s3:GetObject, s3:PutObject) on pricing-data-bucket only",
      "compliance_violations": ["SOC2 CC6.3", "ISO27001 A.9.2.3"],
      "risk_factors": {
        "overprivileged": true,
        "can_access_sensitive_data": true,
        "attached_to_internet_facing_service": true,
        "environment": "production"
      },
      "policy_document": {
        "Version": "2012-10-17",
        "Statement": [
          {
            "Effect": "Allow",
            "Action": "s3:*",
            "Resource": "*"
          }
        ]
      }
    },
    {
      "id": "CNAPP-003",
      "type": "k8s:vulnerability",
      "severity": "critical",
      "resource": "namespace/production/deployment/pricing-engine",
      "resource_type": "kubernetes_deployment",
      "title": "Container image contains Log4Shell vulnerability (CVE-2021-44228)",
      "description": "The pricing-engine deployment is running container image insurance-pricing-api:2.4.1 which contains log4j-core 2.14.0, vulnerable to Log4Shell RCE.",
      "remediation": "Rebuild container image with log4j-core 2.17.1 or later and redeploy",
      "compliance_violations": ["PCI-DSS 6.2", "SOC2 CC7.2", "ISO27001 A.12.6.1"],
      "risk_factors": {
        "has_critical_vulnerability": true,
        "vulnerability_exploited_in_wild": true,
        "internet_exposed": true,
        "processes_sensitive_data": true,
        "environment": "production"
      },
      "cve": "CVE-2021-44228",
      "cvss": 10.0,
      "epss": 0.975,
      "kev": true
    },
    {
      "id": "CNAPP-004",
      "type": "network:exposure",
      "severity": "high",
      "resource": "sg-0a1b2c3d4e5f6g7h8",
      "resource_type": "security_group",
      "title": "Security group allows unrestricted inbound access on port 5432 (PostgreSQL)",
      "description": "Security group 'customers-db-sg' allows inbound traffic from 0.0.0.0/0 on port 5432. This exposes the PostgreSQL database to the entire internet.",
      "remediation": "Restrict inbound rules to specific VPC CIDR blocks or security groups only",
      "compliance_violations": ["PCI-DSS 1.2.1", "HIPAA 164.312(e)(1)", "SOC2 CC6.1"],
      "risk_factors": {
        "allows_public_access": true,
        "exposes_database": true,
        "environment": "production"
      },
      "ingress_rules": [
        {
          "protocol": "tcp",
          "from_port": 5432,
          "to_port": 5432,
          "cidr_blocks": ["0.0.0.0/0"]
        }
      ]
    },
    {
      "id": "CNAPP-005",
      "type": "iam:exposed_credentials",
      "severity": "critical",
      "resource": "arn:aws:iam::123456789012:user/deploy-user",
      "resource_type": "iam_user",
      "title": "Long-lived IAM access key active for more than 90 days",
      "description": "IAM user 'deploy-user' has an access key (AKIA...) that has been active for 247 days without rotation. This violates security best practices and compliance requirements.",
      "remediation": "Rotate access key immediately and implement automatic key rotation policy",
      "compliance_violations": ["PCI-DSS 8.2.4", "SOC2 CC6.1", "ISO27001 A.9.3.1"],
      "risk_factors": {
        "credentials_not_rotated": true,
        "has_admin_privileges": false,
        "last_used": "2025-10-27T08:23:15Z",
        "environment": "production"
      },
      "access_key_age_days": 247,
      "last_rotated": "2024-12-24T10:15:00Z"
    },
    {
      "id": "CNAPP-006",
      "type": "k8s:misconfig",
      "severity": "medium",
      "resource": "namespace/production/deployment/quote-frontend",
      "resource_type": "kubernetes_deployment",
      "title": "Container running as root user",
      "description": "The quote-frontend container is running as root (UID 0). This violates security best practices and increases attack surface if container is compromised.",
      "remediation": "Configure container to run as non-root user in Dockerfile and Kubernetes securityContext",
      "compliance_violations": ["SOC2 CC6.6", "ISO27001 A.14.2.5"],
      "risk_factors": {
        "runs_as_root": true,
        "internet_exposed": true,
        "environment": "production"
      },
      "security_context": {
        "runAsUser": 0,
        "runAsNonRoot": false
      }
    },
    {
      "id": "CNAPP-007",
      "type": "secrets:exposed",
      "severity": "critical",
      "resource": "namespace/production/configmap/billing-gateway-config",
      "resource_type": "kubernetes_configmap",
      "title": "Stripe API secret key stored in plaintext ConfigMap",
      "description": "The billing-gateway ConfigMap contains a Stripe API secret key in plaintext. Secrets should be stored in Kubernetes Secrets with encryption at rest enabled.",
      "remediation": "Move secret to Kubernetes Secret, enable encryption at rest, and use external secrets manager (AWS Secrets Manager or HashiCorp Vault)",
      "compliance_violations": ["PCI-DSS 3.4", "SOC2 CC6.1", "ISO27001 A.10.1.1"],
      "risk_factors": {
        "contains_secrets": true,
        "secrets_not_encrypted": true,
        "accessible_to_multiple_services": true,
        "environment": "production"
      },
      "secret_type": "stripe_api_key"
    },
    {
      "id": "CNAPP-008",
      "type": "runtime:anomaly",
      "severity": "medium",
      "resource": "namespace/production/pod/fraud-detection-7d8f9g0h1i",
      "resource_type": "kubernetes_pod",
      "title": "Unusual outbound network connection detected",
      "description": "The fraud-detection pod established an outbound connection to an IP address (185.220.101.42) not in the approved egress whitelist. This could indicate data exfiltration or compromised container.",
      "remediation": "Investigate connection, review pod logs, and implement network policies to restrict egress traffic",
      "compliance_violations": ["SOC2 CC7.2", "ISO27001 A.13.1.3"],
      "risk_factors": {
        "anomalous_behavior": true,
        "processes_sensitive_data": true,
        "connection_to_unknown_ip": true,
        "environment": "production"
      },
      "connection_details": {
        "destination_ip": "185.220.101.42",
        "destination_port": 443,
        "protocol": "tcp",
        "bytes_transferred": 2457600,
        "timestamp": "2025-10-28T11:45:23Z"
      }
    }
  ],
  "summary": {
    "total_findings": 8,
    "by_severity": {
      "critical": 4,
      "high": 2,
      "medium": 2,
      "low": 0
    },
    "by_type": {
      "k8s:misconfig": 3,
      "iam:overprivileged": 1,
      "iam:exposed_credentials": 1,
      "k8s:vulnerability": 1,
      "network:exposure": 1,
      "secrets:exposed": 1,
      "runtime:anomaly": 1
    },
    "compliance_impact": {
      "PCI-DSS": 5,
      "HIPAA": 2,
      "SOC2": 7,
      "ISO27001": 5,
      "GDPR": 0
    }
  }
}
