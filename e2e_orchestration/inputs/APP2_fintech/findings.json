{
  "scan_time": "2025-10-28T13:15:00Z",
  "scanner": "Prisma Cloud CNAPP",
  "platform": "AWS",
  "account_id": "987654321098",
  "region": "us-east-1",
  "findings": [
    {
      "id": "CNAPP-FIN-001",
      "type": "k8s:vulnerability",
      "severity": "critical",
      "resource": "namespace/production/deployment/blockchain-gateway",
      "resource_type": "kubernetes_deployment",
      "title": "Container image contains critical crypto vulnerability (CVE-2024-11223)",
      "description": "The blockchain-gateway deployment is running container image with ethers.js 5.7.2, vulnerable to private key extraction via timing side-channel. This manages customer cryptocurrency wallets.",
      "remediation": "Rebuild container image with ethers 6.0.0 or later and redeploy immediately",
      "compliance_violations": ["SOC2 CC6.1", "ISO27001 A.12.6.1", "SEC Custody Rule"],
      "risk_factors": {
        "has_critical_vulnerability": true,
        "vulnerability_exploited_in_wild": true,
        "manages_customer_funds": true,
        "internet_exposed": true,
        "environment": "production",
        "financial_impact": "high"
      },
      "cve": "CVE-2024-11223",
      "cvss": 9.8,
      "epss": 0.923,
      "kev": true,
      "estimated_financial_exposure": "$12.5M in customer crypto assets"
    },
    {
      "id": "CNAPP-FIN-002",
      "type": "k8s:vulnerability",
      "severity": "critical",
      "resource": "namespace/production/deployment/order-execution-engine",
      "resource_type": "kubernetes_deployment",
      "title": "Container image contains signature forgery vulnerability (CVE-2023-26115)",
      "description": "The order-execution-engine uses node-forge 1.3.0 for transaction signing. RSA signature verification vulnerability allows attackers to forge valid transaction signatures.",
      "remediation": "Upgrade node-forge to 1.3.1 or later immediately",
      "compliance_violations": ["SOC2 CC6.1", "ISO27001 A.12.6.1", "SEC 17a-4", "FINRA 4511"],
      "risk_factors": {
        "has_critical_vulnerability": true,
        "vulnerability_exploited_in_wild": true,
        "processes_financial_transactions": true,
        "internet_exposed": true,
        "environment": "production",
        "regulatory_impact": "high"
      },
      "cve": "CVE-2023-26115",
      "cvss": 9.1,
      "epss": 0.678,
      "kev": true
    },
    {
      "id": "CNAPP-FIN-003",
      "type": "network:exposure",
      "severity": "critical",
      "resource": "sg-9z8y7x6w5v4u3t2s",
      "resource_type": "security_group",
      "title": "Trading database exposed to internet via security group misconfiguration",
      "description": "Security group 'transactions-db-sg' allows inbound traffic from 0.0.0.0/0 on port 5432. This exposes the time-series trading database containing all transaction history to the internet.",
      "remediation": "Restrict inbound rules to VPC CIDR blocks only",
      "compliance_violations": ["SOC2 CC6.1", "ISO27001 A.13.1.3", "SEC 17a-4", "FINRA 4511"],
      "risk_factors": {
        "allows_public_access": true,
        "exposes_financial_data": true,
        "contains_trading_history": true,
        "regulatory_data": true,
        "environment": "production"
      },
      "ingress_rules": [
        {
          "protocol": "tcp",
          "from_port": 5432,
          "to_port": 5432,
          "cidr_blocks": ["0.0.0.0/0"]
        }
      ]
    },
    {
      "id": "CNAPP-FIN-004",
      "type": "iam:overprivileged",
      "severity": "high",
      "resource": "arn:aws:iam::987654321098:role/order-execution-role",
      "resource_type": "iam_role",
      "title": "Order execution engine has overly permissive DynamoDB access",
      "description": "The order-execution-role has dynamodb:* permissions on all tables. This violates least privilege and could allow unauthorized access to customer accounts and trading data.",
      "remediation": "Restrict DynamoDB permissions to specific tables and actions (GetItem, PutItem, Query) on ledger-table only",
      "compliance_violations": ["SOC2 CC6.3", "ISO27001 A.9.2.3", "SEC Custody Rule"],
      "risk_factors": {
        "overprivileged": true,
        "can_access_financial_data": true,
        "attached_to_internet_facing_service": true,
        "environment": "production"
      },
      "policy_document": {
        "Version": "2012-10-17",
        "Statement": [
          {
            "Effect": "Allow",
            "Action": "dynamodb:*",
            "Resource": "*"
          }
        ]
      }
    },
    {
      "id": "CNAPP-FIN-005",
      "type": "secrets:exposed",
      "severity": "critical",
      "resource": "namespace/production/configmap/payment-processor-config",
      "resource_type": "kubernetes_configmap",
      "title": "Stripe and Plaid API keys stored in plaintext ConfigMap",
      "description": "The payment-processor ConfigMap contains Stripe secret key and Plaid client secret in plaintext. These keys have access to customer bank accounts and payment processing.",
      "remediation": "Move secrets to Kubernetes Secret with encryption at rest, use AWS Secrets Manager",
      "compliance_violations": ["PCI-DSS 3.4", "SOC2 CC6.1", "ISO27001 A.10.1.1"],
      "risk_factors": {
        "contains_secrets": true,
        "secrets_not_encrypted": true,
        "payment_processing_keys": true,
        "bank_account_access": true,
        "environment": "production"
      },
      "secret_types": ["stripe_secret_key", "plaid_client_secret"]
    },
    {
      "id": "CNAPP-FIN-006",
      "type": "k8s:misconfig",
      "severity": "high",
      "resource": "namespace/production/service/market-data-service",
      "resource_type": "kubernetes_service",
      "title": "Market data WebSocket service exposed via LoadBalancer without authentication",
      "description": "The market-data-service WebSocket is exposed to the internet via LoadBalancer. Combined with CVE-2024-34567 (socket.io auth bypass), this allows unauthorized access to proprietary trading signals.",
      "remediation": "Move service behind API Gateway with authentication, upgrade socket.io to 4.6.0",
      "compliance_violations": ["SOC2 CC6.1", "ISO27001 A.13.1.3"],
      "risk_factors": {
        "internet_exposed": true,
        "authentication_bypass_vulnerability": true,
        "exposes_proprietary_data": true,
        "trading_signals": true,
        "environment": "production"
      },
      "affected_workloads": ["market-data-service-primary", "market-data-service-replica-1"]
    },
    {
      "id": "CNAPP-FIN-007",
      "type": "iam:exposed_credentials",
      "severity": "critical",
      "resource": "arn:aws:iam::987654321098:user/trading-bot",
      "resource_type": "iam_user",
      "title": "Trading bot IAM access key active for 412 days without rotation",
      "description": "IAM user 'trading-bot' has an access key that has been active for 412 days. This bot has permissions to execute trades and access customer accounts.",
      "remediation": "Rotate access key immediately and implement automatic 90-day rotation policy",
      "compliance_violations": ["SOC2 CC6.1", "ISO27001 A.9.3.1", "SEC 17a-4"],
      "risk_factors": {
        "credentials_not_rotated": true,
        "has_trading_permissions": true,
        "can_access_customer_accounts": true,
        "last_used": "2025-10-28T09:15:00Z",
        "environment": "production"
      },
      "access_key_age_days": 412,
      "last_rotated": "2024-08-12T14:30:00Z"
    },
    {
      "id": "CNAPP-FIN-008",
      "type": "runtime:anomaly",
      "severity": "critical",
      "resource": "namespace/production/pod/order-execution-engine-5f6g7h8i9j",
      "resource_type": "kubernetes_pod",
      "title": "Unusual high-frequency trading pattern detected - possible market manipulation",
      "description": "The order-execution-engine pod executed 15,234 orders in 3 seconds, all for the same security (AAPL). This pattern is consistent with spoofing or layering market manipulation.",
      "remediation": "Investigate order source, review trading algorithms, implement circuit breakers",
      "compliance_violations": ["SEC Rule 10b-5", "FINRA 5210", "SOC2 CC7.2"],
      "risk_factors": {
        "anomalous_behavior": true,
        "potential_market_manipulation": true,
        "regulatory_violation": true,
        "high_financial_impact": true,
        "environment": "production"
      },
      "trading_details": {
        "security": "AAPL",
        "order_count": 15234,
        "time_window_seconds": 3,
        "total_volume": "$45.2M",
        "timestamp": "2025-10-28T13:12:45Z",
        "pattern": "spoofing"
      }
    },
    {
      "id": "CNAPP-FIN-009",
      "type": "compliance:violation",
      "severity": "high",
      "resource": "namespace/production/deployment/kyc-verification-service",
      "resource_type": "kubernetes_deployment",
      "title": "KYC service logging PII in plaintext violates AML regulations",
      "description": "The kyc-verification-service logs customer SSN, passport numbers, and addresses in plaintext. This violates AML/KYC data protection requirements.",
      "remediation": "Implement log redaction for PII fields, encrypt logs at rest",
      "compliance_violations": ["AML BSA", "KYC CIP", "SOC2 CC6.1", "GDPR Article 32"],
      "risk_factors": {
        "logs_pii": true,
        "logs_not_encrypted": true,
        "regulatory_data": true,
        "environment": "production"
      },
      "pii_types": ["ssn", "passport_number", "address", "date_of_birth"]
    },
    {
      "id": "CNAPP-FIN-010",
      "type": "k8s:misconfig",
      "severity": "medium",
      "resource": "namespace/production/deployment/fraud-detection-ml",
      "resource_type": "kubernetes_deployment",
      "title": "ML model container running with privileged mode enabled",
      "description": "The fraud-detection-ml container is running with privileged: true. This grants unnecessary host access and increases attack surface.",
      "remediation": "Remove privileged mode, use securityContext with specific capabilities only",
      "compliance_violations": ["SOC2 CC6.6", "ISO27001 A.14.2.5"],
      "risk_factors": {
        "privileged_container": true,
        "processes_sensitive_data": true,
        "environment": "production"
      },
      "security_context": {
        "privileged": true,
        "runAsUser": 0
      }
    }
  ],
  "summary": {
    "total_findings": 10,
    "by_severity": {
      "critical": 6,
      "high": 3,
      "medium": 1,
      "low": 0
    },
    "by_type": {
      "k8s:vulnerability": 2,
      "k8s:misconfig": 3,
      "iam:overprivileged": 1,
      "iam:exposed_credentials": 1,
      "network:exposure": 1,
      "secrets:exposed": 1,
      "runtime:anomaly": 1,
      "compliance:violation": 1
    },
    "compliance_impact": {
      "SOC2": 9,
      "ISO27001": 7,
      "SEC": 5,
      "FINRA": 3,
      "PCI-DSS": 1,
      "AML": 2,
      "KYC": 2,
      "GDPR": 1
    },
    "estimated_financial_exposure": "$12.5M+ in customer assets at risk"
  }
}
